<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Learning Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-purple': '#6a44d9',
          }
        }
      }
    }
  </script>
  <style>
    .active-nav-item {
      background-color: #f3f4f6;
      color: #6a44d9;
    }
    
    .course-filter-badge {
      font-size: 0.75rem;
      padding: 0.125rem 0.375rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      color: #4b5563;
    }
    
    .course-filter-badge.active {
      background-color: #6a44d9;
      color: white;
    }
    
    .lesson-completed {
      border-left: 3px solid #10b981;
    }
    
    .lesson-in-progress {
      border-left: 3px solid #3b82f6;
    }
    
    /* Add progress bar styling */
    .progress-bar {
      height: 0.25rem;
      background-color: #e5e7eb;
      border-radius: 9999px;
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background-color: #6a44d9;
      transition: width 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    .animate-fade-in {
      animation: fadeIn 0.3s ease-in-out forwards;
    }

    .opacity-0 {
      opacity: 0;
      transition: opacity 0.3s ease-out;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Your existing styles & Tailwind config here -->
  <script src="config.js"></script>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
  <!-- Top Navigation -->
  <nav id="main-nav" class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40">
    <!-- Nav content will be rendered by JavaScript -->
  </nav>

  <!-- Additional container for width constraints if needed -->
  <div class="max-w-7xl mx-auto">
    <div class="flex">
      <!-- Sidebar Template -->
      <aside id="sidebar" class="w-64 bg-white border-r border-gray-200 h-[calc(100vh-4rem)] sticky top-16 overflow-y-auto">
        <!-- Sidebar content will be rendered by JavaScript -->
      </aside>

      <!-- Main Content Area -->
      <div id="main-content" class="flex-1 p-6">
        <!-- Content will be rendered by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Templates - These are hidden and used by JavaScript -->
  <div id="templates" class="hidden">
    <!-- Course Card Template -->
    <template id="course-card-template">
      <div class="course-card bg-white rounded-lg shadow-md overflow-hidden flex flex-col border border-gray-200">
        <div class="course-image-container relative">
          <img class="course-image h-48 w-full object-cover" src="" alt="">
          <div class="enrolled-badge absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full hidden">
            <i class="fas fa-user-check mr-1"></i>Enrolled
          </div>
        </div>
        <div class="p-5 flex flex-col flex-1 border-t border-gray-100">
          <h2 class="course-title text-xl font-bold mb-2 text-gray-800 leading-tight"></h2>
          <p class="course-instructor text-sm text-gray-600 mb-1">
            <i class="fas fa-user-tie mr-2"></i><span></span>
          </p>
          <p class="course-duration text-sm text-gray-600 mb-3">
            <i class="fas fa-clock mr-2"></i><span></span>
          </p>
          <p class="course-description text-gray-700 text-sm mb-4 flex-grow"></p>
          <div class="enroll-button-container mb-4"></div>
          <hr class="border-gray-200 mb-4">
          <div class="course-progress-container"></div>
          <div class="lessons-container"></div>
        </div>
      </div>
    </template>

    <!-- Lesson Button Template -->
    <template id="lesson-button-template">
      <button class="lesson-button flex items-center justify-between w-full text-left p-3 rounded-lg transition-colors">
        <div class="flex items-center">
          <i class="lesson-icon mr-3"></i>
          <span class="lesson-title"></span>
        </div>
        <div class="flex items-center">
          <span class="lesson-progress text-xs mr-2"></span>
          <span class="lesson-arrow text-gray-400">
            <i class="fas fa-chevron-right"></i>
          </span>
        </div>
      </button>
    </template>

    <!-- Course Tree Item Template -->
    <template id="course-tree-item-template">
      <li class="course-tree-item mb-2 overflow-hidden">
        <div class="flex items-center justify-between py-2 px-1 hover:bg-gray-50 rounded cursor-pointer">
          <div class="flex items-center flex-grow min-w-0">
            <span class="course-tree-toggle text-gray-400 mr-2">
              <i class="fas fa-chevron-right"></i>
            </span>
            <span class="course-icon mr-2">
              <i class="fas fa-book"></i>
            </span>
            <span class="course-tree-title truncate font-medium text-sm"></span>
          </div>
        </div>
        <div class="course-tree-lessons ml-4"></div>
      </li>
    </template>
    
    <!-- More templates for other components... -->
  </div>

  <!-- Modal Templates -->
  <div id="video-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
    <!-- Video modal content -->
  </div>

  <div id="document-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
    <!-- Document modal content -->
  </div>

  <script>
    // Global state
    const AppState = {
      data: {
        courses: [],
        currentView: 'courses',
        currentCourseId: null,
        currentLessonId: null,
        filters: {
          courseTree: 'all',
          searchQuery: ''
        }
      },
      
      configUrl: 'courses-data.json', // Default relative path
      
      // State management methods
      async init(configUrl) {
        // Show loading indicator
        this.showLoadingIndicator();
        
        // Allow override of config URL
        if (configUrl) {
          this.configUrl = configUrl;
        }
        
        try {
          // Load configuration from external JSON file
          await this.loadConfiguration();
          
          // Load user data from localStorage
          this.loadUserData();
          
          // Initialize UI
          this.render();
          
          // Set up event listeners for global components
          this.setupEventListeners();
        } catch (error) {
          console.error("Failed to initialize application:", error);
          this.showToast('Failed to load course data. Please try again later.', 'error');
        } finally {
          // Hide loading indicator
          this.hideLoadingIndicator();
        }
      },
      
      async loadConfiguration() {
        try {
          const response = await fetch(this.configUrl);
          
          if (!response.ok) {
            throw new Error(`Failed to load configuration from ${this.configUrl}: ${response.status} ${response.statusText}`);
          }
          
          let config;
          let jsonText = await response.text();
          
          // Try to fix common JSON syntax issues
          if (jsonText.startsWith('//')) {
            // Remove any comment lines at the beginning
            jsonText = jsonText.replace(/^\/\/.*$/gm, '').trim();
          }
          
          try {
            config = JSON.parse(jsonText);
          } catch (parseError) {
            console.error("JSON Parse Error:", parseError);
            console.error("JSON Content (first 500 chars):", jsonText.substring(0, 500));
            
            // Last resort: Create a default config
            console.warn("Using default configuration as fallback");
            config = {
              "title": "Learning Platform",
              "pageTitle": "My Courses",
              "courses": []
            };
          }
          
          // Update application with loaded configuration
          this.platformTitle = config.title || "Learning Platform";
          this.pageTitle = config.pageTitle || "My Courses";
          this.data.courses = config.courses || [];
          
          console.log(`Configuration loaded from ${this.configUrl}`);
        } catch (error) {
          console.error("Error loading configuration:", error);
          throw error;
        }
      },
      
      initWithConfig(config) {
        // Show loading indicator
        this.showLoadingIndicator();
        
        try {
          // Update application with provided configuration
          this.platformTitle = config.title || "Learning Platform";
          this.pageTitle = config.pageTitle || "My Courses";
          this.data.courses = config.courses || [];
          
          // Load user data from localStorage
          this.loadUserData();
          
          // Initialize UI
          this.render();
          
          // Set up event listeners for global components
          this.setupEventListeners();
          
          console.log("Configuration loaded from JS object");
        } catch (error) {
          console.error("Failed to initialize application:", error);
          this.showToast('Failed to load course data. Please try again later.', 'error');
        } finally {
          // Hide loading indicator
          this.hideLoadingIndicator();
        }
      },
      
      loadUserData() {
        const storedData = localStorage.getItem('learningData');
        if (storedData) {
          try {
            this.userData = JSON.parse(storedData);
          } catch (e) {
            console.error("Error parsing stored data:", e);
            this.userData = this.createEmptyUserData();
          }
        } else {
          this.userData = this.createEmptyUserData();
        }
      },
      
      createEmptyUserData() {
        return {
          courses: {},
          lastUpdated: Date.now()
        };
      },
      
      saveUserData() {
        this.userData.lastUpdated = Date.now();
        localStorage.setItem('learningData', JSON.stringify(this.userData));
      },
      
      render() {
        this.renderNavigation();
        this.renderSidebar();
        this.renderMainContent();
      },
      
      setupEventListeners() {
        // Global event delegation
        document.addEventListener('click', this.handleGlobalClick.bind(this));
      },
      
      handleGlobalClick(event) {
        // Example of event delegation
        if (event.target.closest('#showAllCoursesBtn')) {
          this.data.currentView = 'courses';
          this.render();
        } else if (event.target.closest('#showMyProgressBtn')) {
          this.data.currentView = 'progress';
          this.render();
        }
        // Add more global click handlers...
      },
      
      // Component rendering methods
      renderNavigation() {
        const nav = document.getElementById('main-nav');
        nav.innerHTML = `
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
              <div class="flex items-center">
                <span id="brandLogo" class="text-2xl font-bold text-brand-purple">
                  <i class="fas fa-graduation-cap mr-2"></i>
                  <span id="navTitle">${this.platformTitle}</span>
                </span>
              </div>
              
              <div class="flex items-center">
                <button class="ml-4 p-2 rounded-full hover:bg-gray-100">
                  <i class="fas fa-user-circle text-gray-500 text-xl"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      },
      
      renderSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.innerHTML = `
          <div class="flex justify-end p-2">
            <button id="sidebarToggle" class="text-gray-500 hover:text-brand-purple p-1 rounded-md">
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>
          
          <div class="p-4">
            <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3">
              Navigation
            </h3>

            <div class="space-y-2">
              <button id="showAllCoursesBtn" class="flex items-center w-full px-3 py-2 text-gray-900 rounded-md hover:bg-gray-100 group ${this.data.currentView === 'courses' ? 'active-nav-item' : ''}">
                <i class="fas fa-book-open mr-3 text-brand-purple"></i>
                <span class="font-medium">All Courses</span>
              </button>
              
              <button id="showMyProgressBtn" class="flex items-center w-full px-3 py-2 text-gray-600 rounded-md hover:bg-gray-100 group ${this.data.currentView === 'progress' ? 'active-nav-item' : ''}">
                <i class="fas fa-chart-line mr-3 text-gray-400"></i>
                <span class="font-medium">My Progress</span>
              </button>
            </div>
          </div>

          <div id="courseTree" class="mt-4 border-t border-gray-200 pt-4">
            <div class="flex items-center justify-between px-4 mb-3">
              <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">
                Courses
              </h3>
              <div class="flex items-center space-x-1">
                <button id="filterAllCourses" class="course-filter-badge ${this.data.filters.courseTree === 'all' ? 'active' : ''}">All</button>
                <button id="filterEnrolledCourses" class="course-filter-badge ${this.data.filters.courseTree === 'enrolled' ? 'active' : ''}">Enrolled</button>
              </div>
            </div>
            
            <div class="px-2 mb-2">
              <div class="relative">
                <input 
                  id="courseTreeSearch" 
                  type="text" 
                  placeholder="Filter courses..." 
                  class="w-full py-1 px-2 pl-7 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-brand-purple focus:border-brand-purple"
                  value="${this.data.filters.searchQuery}"
                >
                <div class="absolute inset-y-0 left-0 flex items-center pl-2 pointer-events-none">
                  <i class="fas fa-search text-gray-400 text-xs"></i>
                </div>
                <button id="clearTreeSearch" class="absolute inset-y-0 right-0 flex items-center pr-2 text-gray-400 hover:text-gray-600 ${this.data.filters.searchQuery ? '' : 'hidden'}">
                  <i class="fas fa-times text-xs"></i>
                </button>
              </div>
            </div>
            
            <div class="space-y-1 px-2 overflow-y-auto" style="max-height: calc(100vh - 13rem);">
              <ul id="courseTreeList" class="space-y-1">
                <!-- Course tree items are rendered by renderCourseTree() -->
              </ul>
            </div>
          </div>
        `;
        
        this.renderCourseTree();
        this.setupSidebarEventListeners();
      },
      
      renderCourseTree() {
        const courseTreeList = document.getElementById('courseTreeList');
        if (!courseTreeList) return;
        
        courseTreeList.innerHTML = '';
        
        // Filter courses based on the selected filter
        let coursesToShow = this.data.courses;
        
        // If "enrolled" filter is selected, only show enrolled courses
        if (this.data.filters.courseTree === 'enrolled') {
          coursesToShow = this.data.courses.filter(course => this.checkEnrollmentStatus(course.id));
        }
        
        // If there's a search query, filter by it
        if (this.data.filters.searchQuery) {
          const query = this.data.filters.searchQuery.toLowerCase();
          coursesToShow = coursesToShow.filter(course => 
            course.title.toLowerCase().includes(query) || 
            course.description.toLowerCase().includes(query) ||
            course.lessons.some(lesson => lesson.title.toLowerCase().includes(query))
          );
        }
        
        // If no courses to show after filtering
        if (coursesToShow.length === 0) {
          courseTreeList.innerHTML = `
            <li class="px-2 py-3 text-gray-500 text-center text-sm">
              <i class="fas fa-info-circle mr-2"></i>
              No courses found
            </li>
          `;
          return;
        }
        
        // Create course tree items
        coursesToShow.forEach(course => {
          const template = document.getElementById('course-tree-item-template');
          const item = template.content.cloneNode(true);
          
          // Set course data and title
          const courseItem = item.querySelector('.course-tree-item');
          courseItem.dataset.courseId = course.id;
          item.querySelector('.course-tree-title').textContent = course.title;
          
          // Set icon based on enrollment status
          const iconElement = item.querySelector('.course-icon i');
          if (this.checkEnrollmentStatus(course.id)) {
            iconElement.className = 'fas fa-book text-green-500';
          }
          
          // Add click handler for expanding/collapsing
          const headerDiv = item.querySelector('.course-tree-item > div');
          const toggleIcon = item.querySelector('.course-tree-toggle i');
          const lessonsList = item.querySelector('.course-tree-lessons');
          
          // Initially hide lessons
          lessonsList.classList.add('hidden');
          
          // Click handler to toggle lessons visibility
          headerDiv.addEventListener('click', () => {
            lessonsList.classList.toggle('hidden');
            toggleIcon.classList.toggle('fa-chevron-right');
            toggleIcon.classList.toggle('fa-chevron-down');
          });
          
          // Populate lessons
          course.lessons.forEach(lesson => {
            const lessonItem = document.createElement('div');
            lessonItem.className = 'py-1 pl-2';
            
            // Determine if lesson is completed or in progress
            let lessonIcon, textClass;
            const progress = this.getLessonProgress(course.id, lesson.id);
            
            if (progress >= 1) {
              lessonIcon = '<i class="fas fa-check-circle text-green-500 mr-2"></i>';
              textClass = 'text-gray-700';
            } else if (progress > 0) {
              if (lesson.contentType === 'video') {
                lessonIcon = '<i class="fas fa-play-circle text-blue-500 mr-2"></i>';
              } else {
                lessonIcon = '<i class="fas fa-file-alt text-blue-500 mr-2"></i>';
              }
              textClass = 'text-gray-700';
            } else {
              if (lesson.contentType === 'video') {
                lessonIcon = '<i class="fas fa-play-circle text-gray-400 mr-2"></i>';
              } else {
                lessonIcon = '<i class="fas fa-file-alt text-gray-400 mr-2"></i>';
              }
              textClass = 'text-gray-500';
            }
            
            lessonItem.innerHTML = `
              <a href="#" class="flex items-center text-sm ${textClass} hover:text-gray-900 truncate">
                ${lessonIcon}
                <span class="truncate">${lesson.title}</span>
              </a>
            `;
            
            // Add click handler for lesson
            lessonItem.querySelector('a').addEventListener('click', (e) => {
              e.preventDefault();
              this.data.currentCourseId = course.id;
              this.data.currentLessonId = lesson.id;
              this.data.currentView = 'course-details';
              this.render();
            });
            
            lessonsList.appendChild(lessonItem);
          });
          
          courseTreeList.appendChild(item);
        });
      },

      getLessonProgress(courseId, lessonId) {
        return this.userData?.courses?.[courseId]?.lessons?.[lessonId]?.progress || 0;
      },

      isLessonCompleted(courseId, lessonId) {
        return this.getLessonProgress(courseId, lessonId) >= 1;
      },

      setupSidebarEventListeners() {
        // Course tree filter buttons
        const filterAllBtn = document.getElementById('filterAllCourses');
        const filterEnrolledBtn = document.getElementById('filterEnrolledCourses');
        
        if (filterAllBtn && filterEnrolledBtn) {
          filterAllBtn.addEventListener('click', () => {
            this.data.filters.courseTree = 'all';
            this.renderCourseTree();
          });
          
          filterEnrolledBtn.addEventListener('click', () => {
            this.data.filters.courseTree = 'enrolled';
            this.renderCourseTree();
          });
        }
        
        // Course tree search
        const searchInput = document.getElementById('courseTreeSearch');
        const clearSearch = document.getElementById('clearTreeSearch');
        
        if (searchInput && clearSearch) {
          searchInput.addEventListener('input', () => {
            this.data.filters.searchQuery = searchInput.value;
            
            if (searchInput.value) {
              clearSearch.classList.remove('hidden');
            } else {
              clearSearch.classList.add('hidden');
            }
            
            this.renderCourseTree();
          });
          
          clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            this.data.filters.searchQuery = '';
            clearSearch.classList.add('hidden');
            this.renderCourseTree();
          });
        }
        
        // Sidebar toggle
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');

        if (sidebarToggle && sidebar) {
          sidebarToggle.addEventListener('click', () => {
            // Toggle sidebar width
            sidebar.classList.toggle('w-64');
            sidebar.classList.toggle('w-16');
            
            // Add left padding to main content when sidebar is expanded
            // This ensures content doesn't jump when toggling
            mainContent.classList.toggle('md:pl-64');
            mainContent.classList.toggle('md:pl-16');
            
            const sidebarCollapsed = sidebar.classList.contains('w-16');
            
            // Update toggle icon
            sidebarToggle.innerHTML = sidebarCollapsed ? 
              '<i class="fas fa-chevron-right"></i>' : 
              '<i class="fas fa-chevron-left"></i>';
            
            // Hide/show content based on collapsed state
            const elementsToToggle = sidebar.querySelectorAll('.p-4, #courseTree');
            elementsToToggle.forEach(el => {
              el.classList.toggle('hidden', sidebarCollapsed);
            });
          });
        }
      },
      
      renderMainContent() {
        const mainContent = document.getElementById('main-content');
        
        // Clear content
        mainContent.innerHTML = '';
        
        // Render based on current view
        switch(this.data.currentView) {
          case 'courses':
            mainContent.appendChild(this.renderCoursesPage());
            break;
          case 'progress':
            mainContent.appendChild(this.renderProgressPage());
            break;
          case 'course-details':
            mainContent.appendChild(this.renderCourseDetailsPage());
            break;
          default:
            mainContent.appendChild(this.renderCoursesPage());
        }
      },

      renderCourseDetailsPage() {
        const page = document.createElement('div');
        page.id = 'courseDetailsPage';
        page.className = 'block';
        
        // Find the course by ID
        const courseId = this.data.currentCourseId;
        const course = this.data.courses.find(c => c.id === courseId);
        
        if (!course) {
          page.innerHTML = `
            <div class="text-center py-10">
              <div class="text-gray-400 mb-4"><i class="fas fa-exclamation-circle text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">Course Not Found</h3>
              <p class="text-gray-500 mb-4">The requested course could not be found.</p>
              <button id="backToCoursesBtn" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                <i class="fas fa-arrow-left mr-2"></i>Back to Courses
              </button>
            </div>
          `;
          
          setTimeout(() => {
            document.getElementById('backToCoursesBtn').addEventListener('click', () => {
              this.data.currentView = 'courses';
              this.render();
            });
          }, 0);
          
          return page;
        }
        
        // Check enrollment status
        const isEnrolled = this.checkEnrollmentStatus(courseId);
        
        // Find current lesson if one is selected
        let currentLesson = null;
        if (this.data.currentLessonId) {
          currentLesson = course.lessons.find(l => l.id === this.data.currentLessonId);
        } else if (course.lessons.length > 0) {
          // Default to first lesson if none selected
          currentLesson = course.lessons[0];
          this.data.currentLessonId = currentLesson.id;
        }
        
        // Calculate course progress
        let totalProgress = 0;
        let completedLessons = 0;
        
        course.lessons.forEach(lesson => {
          const progress = this.getLessonProgress(courseId, lesson.id);
          totalProgress += progress;
          if (progress >= 1) completedLessons++;
        });
        
        const averageProgress = course.lessons.length > 0 ? totalProgress / course.lessons.length : 0;
        const progressPercent = Math.round(averageProgress * 100);
        
        // Render course details page
        page.innerHTML = `
          <div class="mb-6">
            <div class="flex items-center mb-4">
              <button id="backToCoursesBtn" class="text-gray-600 hover:text-gray-900 mr-3">
                <i class="fas fa-arrow-left"></i>
              </button>
              <h1 class="text-2xl font-bold text-gray-900">${course.title}</h1>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
              <div class="flex flex-col md:flex-row gap-6">
                <!-- Course image and info -->
                <div class="w-full md:w-1/3">
                  <img src="${course.image}" alt="${course.title}" class="w-full rounded-lg mb-4">
                  
                  <div class="mb-4">
                    <h3 class="font-semibold text-gray-700 mb-1">Instructor</h3>
                    <p class="text-gray-600">${course.instructor}</p>
                  </div>
                  
                  <div class="mb-4">
                    <h3 class="font-semibold text-gray-700 mb-1">Duration</h3>
                    <p class="text-gray-600">${course.duration}</p>
                  </div>
                  
                  <div class="mb-4">
                    <h3 class="font-semibold text-gray-700 mb-1">Course Progress</h3>
                    <div class="flex items-center justify-between mb-1">
                      <span class="text-sm text-gray-600">${completedLessons} of ${course.lessons.length} lessons completed</span>
                    </div>
                    <div class="progress-bar">
                      <div class="progress-bar-fill" style="width: ${progressPercent}%"></div>
                    </div>
                    <div class="flex justify-end mt-1">
                      <span class="text-xs text-gray-600">${progressPercent}% complete</span>
                    </div>
                  </div>
                  
                  <div class="mb-4">
                    <h3 class="font-semibold text-gray-700 mb-1">Description</h3>
                    <p class="text-gray-600 text-sm">${course.description}</p>
                  </div>
                  
                  <div>
                    ${isEnrolled ? 
                      `<button id="unenrollBtn" class="w-full py-2 px-4 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors">
                        <i class="fas fa-user-minus mr-2"></i>Unenroll
                      </button>` : 
                      `<button id="enrollBtn" class="w-full py-2 px-4 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors">
                        <i class="fas fa-user-plus mr-2"></i>Enroll in Course
                      </button>`
                    }
                  </div>
                </div>
                
                <!-- Course content -->
                <div class="w-full md:w-2/3">
                  <div class="mb-4">
                    <h2 class="text-xl font-semibold text-gray-800 mb-3">Course Content</h2>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                      <div class="flex space-x-1 mb-4">
                        <button class="lesson-tab-btn active px-3 py-1 text-sm" data-tab="lessons">
                          <i class="fas fa-list-ul mr-1"></i> Lessons
                        </button>
                      </div>
                      
                      <div id="lessonsTabContent" class="tab-content active">
                        <div id="lessonsAccordion" class="space-y-2">
                          <!-- Rendered by renderLessonsAccordion() -->
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Current lesson content -->
                  ${currentLesson ? `
                    <div id="currentLessonContainer" class="bg-white rounded-lg shadow-md p-4 overflow-hidden">
                      <h3 class="text-lg font-semibold text-gray-800 mb-3">${currentLesson.title}</h3>
                      
                      ${currentLesson.contentType === 'video' ? `
                        <div class="aspect-w-16 aspect-h-9 mb-4">
                          <div id="videoPlayer" class="bg-black w-full h-[400px] flex items-center justify-center">
                            <!-- Video player will be loaded here -->
                            <div class="text-white text-center">
                              <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-white mx-auto mb-4"></div>
                              <p>Loading video...</p>
                            </div>
                          </div>
                          
                          <div class="mt-2 flex items-center justify-between">
                            <div class="flex items-center">
                              <span class="text-sm text-gray-600 mr-2">Progress:</span>
                              <div class="progress-bar w-32">
                                <div id="videoProgressBar" class="progress-bar-fill" style="width: 0%"></div>
                              </div>
                            </div>
                            <span id="videoProgressText" class="text-xs text-gray-600">0%</span>
                          </div>
                        </div>
                      ` : `
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                          <p class="text-gray-700">
                            <i class="fas fa-file-alt text-gray-400 mr-2"></i>
                            Document content will be displayed here.
                          </p>
                        </div>
                      `}
                      
                      ${currentLesson.additionalResources && currentLesson.additionalResources.length > 0 ? `
                        <div class="mt-6">
                          <h4 class="text-md font-semibold text-gray-700 mb-2">Additional Resources</h4>
                          <div class="space-y-2">
                            ${currentLesson.additionalResources.map(resource => `
                              <a href="${resource.url}" target="_blank" 
                                class="flex items-center p-2 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors">
                                <i class="fas ${resource.type === 'pdf' ? 'fa-file-pdf text-red-500' : 
                                                resource.type === 'doc' ? 'fa-file-word text-blue-500' : 
                                                'fa-external-link-alt text-gray-500'} mr-2"></i>
                                <div>
                                  <div class="font-medium text-sm">${resource.title}</div>
                                  <div class="text-xs text-gray-500">${resource.description || ''}</div>
                                </div>
                              </a>
                            `).join('')}
                          </div>
                        </div>
                      ` : ''}
                    </div>
                  ` : `
                    <div class="bg-gray-50 rounded-lg p-6 text-center">
                      <div class="text-gray-400 mb-4"><i class="fas fa-book-open text-5xl"></i></div>
                      <h3 class="text-xl font-semibold text-gray-700 mb-2">No Lesson Selected</h3>
                      <p class="text-gray-500">Please select a lesson from the list to view its content.</p>
                    </div>
                  `}
                </div>
              </div>
            </div>
          </div>
        `;
        
        // After the page is added to the DOM, initialize components
        setTimeout(() => {
          this.renderLessonsAccordion(courseId);
          this.setupCourseDetailsEventListeners(courseId);
          
          // Initialize video player if there's a video lesson
          if (currentLesson && currentLesson.contentType === 'video') {
            this.initializeVideoPlayer(courseId, currentLesson);
          }
        }, 0);
        
        return page;
      },

      renderLessonsAccordion(courseId) {
        const accordion = document.getElementById('lessonsAccordion');
        if (!accordion) return;
        
        const course = this.data.courses.find(c => c.id === courseId);
        if (!course) return;
        
        accordion.innerHTML = '';
        
        course.lessons.forEach((lesson, index) => {
          const progress = this.getLessonProgress(courseId, lesson.id);
          const isCompleted = progress >= 1;
          const isInProgress = progress > 0 && progress < 1;
          const isCurrent = lesson.id === this.data.currentLessonId;
          
          const lessonItem = document.createElement('div');
          lessonItem.className = `lesson-item border rounded-lg overflow-hidden ${isCurrent ? 'border-brand-purple' : 'border-gray-200'}`;
          lessonItem.dataset.lessonId = lesson.id;
          
          // Define status icon and colors
          let statusIcon, statusClass;
          if (isCompleted) {
            statusIcon = '<i class="fas fa-check-circle text-green-500"></i>';
            statusClass = 'text-green-500';
          } else if (isInProgress) {
            statusIcon = '<i class="fas fa-spinner text-blue-500"></i>';
            statusClass = 'text-blue-500';
          } else {
            statusIcon = '<i class="far fa-circle text-gray-400"></i>';
            statusClass = 'text-gray-400';
          }
          
          // Define content type icon
          const contentIcon = lesson.contentType === 'video' ? 
            '<i class="fas fa-play-circle text-gray-500 mr-1"></i>' : 
            '<i class="fas fa-file-alt text-gray-500 mr-1"></i>';
          
          lessonItem.innerHTML = `
            <button class="lesson-header w-full flex items-center justify-between p-4 bg-white hover:bg-gray-50 ${isCurrent ? 'bg-purple-50' : ''}">
              <div class="flex items-center">
                <span class="lesson-status mr-3">${statusIcon}</span>
                <div>
                  <div class="font-medium text-left">${lesson.title}</div>
                  <div class="flex items-center text-xs text-gray-500 mt-1">
                    ${contentIcon}
                    <span>${lesson.contentType === 'video' ? 'Video' : 'Document'}</span>
                    ${isInProgress ? `<span class="ml-2 ${statusClass}">(${Math.round(progress * 100)}% complete)</span>` : ''}
                  </div>
                </div>
              </div>
              <div class="text-right">
                <span class="text-xs px-2 py-1 rounded-full ${isCurrent ? 'bg-brand-purple text-white' : 'bg-gray-100 text-gray-600'}">
                  ${isCurrent ? 'Current' : 'View'}
                </span>
              </div>
            </button>
          `;
          
          // Add click handler
          lessonItem.querySelector('.lesson-header').addEventListener('click', () => {
            this.data.currentLessonId = lesson.id;
            this.render();
          });
          
          accordion.appendChild(lessonItem);
        });
      },

      setupCourseDetailsEventListeners(courseId) {
        // Back button
        const backBtn = document.getElementById('backToCoursesBtn');
        if (backBtn) {
          backBtn.addEventListener('click', () => {
            this.data.currentView = 'courses';
            this.render();
          });
        }
        
        // Enroll button
        const enrollBtn = document.getElementById('enrollBtn');
        if (enrollBtn) {
          enrollBtn.addEventListener('click', () => {
            this.enrollInCourse(courseId);
          });
        }
        
        // Unenroll button
        const unenrollBtn = document.getElementById('unenrollBtn');
        if (unenrollBtn) {
          unenrollBtn.addEventListener('click', () => {
            this.unenrollFromCourse(courseId);
          });
        }
        
        // Tab buttons
        const tabButtons = document.querySelectorAll('.lesson-tab-btn');
        tabButtons.forEach(button => {
          button.addEventListener('click', () => {
            // Remove active class from all buttons and contents
            tabButtons.forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => {
              content.classList.remove('active');
            });
            
            // Add active class to clicked button and corresponding content
            button.classList.add('active');
            const tabId = button.dataset.tab;
            document.getElementById(`${tabId}TabContent`).classList.add('active');
          });
        });
      },

      initializeVideoPlayer(courseId, lesson) {
        // Implement video player initialization here
        // This is just a placeholder - you would need to implement proper video playback
        const videoContainer = document.getElementById('videoPlayer');
        if (!videoContainer) return;
        
        // Simple video player
        videoContainer.innerHTML = `
          <video id="lessonVideo" controls class="w-full h-full" preload="auto">
            <source src="${lesson.videoUrl}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        `;
        
        const video = document.getElementById('lessonVideo');
        const progressBar = document.getElementById('videoProgressBar');
        const progressText = document.getElementById('videoProgressText');
        
        // Get current progress from user data
        const currentProgress = this.getLessonProgress(courseId, lesson.id) || 0;
        
        // Set initial progress display
        const progressPercent = Math.round(currentProgress * 100);
        progressBar.style.width = `${progressPercent}%`;
        progressText.textContent = `${progressPercent}%`;
        
        // Set video to saved position
        if (currentProgress > 0 && video) {
          video.addEventListener('loadedmetadata', () => {
            const seekTime = video.duration * currentProgress;
            if (!isNaN(seekTime)) {
              video.currentTime = seekTime;
            }
          });
        }
        
        // Update progress as video plays
        let progressUpdateInterval;
        
        if (video) {
          video.addEventListener('play', () => {
            // Update progress every 5 seconds
            progressUpdateInterval = setInterval(() => {
              if (video.duration) {
                const newProgress = video.currentTime / video.duration;
                
                // Update UI
                const newProgressPercent = Math.round(newProgress * 100);
                progressBar.style.width = `${newProgressPercent}%`;
                progressText.textContent = `${newProgressPercent}%`;
                
                // Save progress
                this.updateLessonProgress(courseId, lesson.id, newProgress);
              }
            }, 5000);
          });
          
          video.addEventListener('pause', () => {
            clearInterval(progressUpdateInterval);
            
            // Save progress on pause
            if (video.duration) {
              const newProgress = video.currentTime / video.duration;
              this.updateLessonProgress(courseId, lesson.id, newProgress);
            }
          });
          
          video.addEventListener('ended', () => {
            clearInterval(progressUpdateInterval);
            
            // Mark as completed
            this.updateLessonProgress(courseId, lesson.id, 1);
            progressBar.style.width = '100%';
            progressText.textContent = '100%';
          });
        }
      },

      updateLessonProgress(courseId, lessonId, progress) {
        // Initialize the course data if it doesn't exist
        if (!this.userData.courses[courseId]) {
          this.userData.courses[courseId] = { 
            enrolled: true,
            lessons: {} 
          };
        }
        
        // Initialize the lesson data if it doesn't exist
        if (!this.userData.courses[courseId].lessons) {
          this.userData.courses[courseId].lessons = {};
        }
        
        // Update the progress
        if (!this.userData.courses[courseId].lessons[lessonId]) {
          this.userData.courses[courseId].lessons[lessonId] = {};
        }
        
        this.userData.courses[courseId].lessons[lessonId].progress = progress;
        this.userData.courses[courseId].lessons[lessonId].lastAccessed = Date.now();
        
        // Save the updated user data
        this.saveUserData();
      },

      renderCoursesPage() {
        const page = document.createElement('div');
        page.id = 'allCoursesPage';
        page.className = 'block';
        
        page.innerHTML = `
          <div class="mb-8 border-b border-gray-200 pb-4">
            <h1 id="platformTitle" class="text-3xl font-bold text-gray-900 mb-2">${this.pageTitle}</h1>
            <div class="flex items-center justify-between flex-wrap gap-4">
              <p class="text-gray-600">Continue learning where you left off</p>
              
              <div class="relative w-full max-w-md">
                <input 
                  id="searchInput" 
                  type="text" 
                  placeholder="Search for courses or lessons..." 
                  class="w-full py-2 pl-10 pr-4 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-brand-purple focus:border-transparent"
                  value="${this.data.filters.searchQuery}"
                >
                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                  <i class="fas fa-search text-gray-400"></i>
                </div>
                <button id="clearSearch" class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600 ${this.data.filters.searchQuery ? '' : 'hidden'}">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          </div>
          
          <div id="courses" class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <!-- Course cards are rendered by renderCourseCards() -->
          </div>
        `;
        
        // After the page is added to the DOM, render course cards
        setTimeout(() => {
          this.renderCourseCards();
          this.setupCoursesPageEventListeners();
        }, 0);
        
        return page;
      },

      renderCourseCards() {
        const container = document.getElementById('courses');
        if (!container) return;
        
        // Clear existing cards
        container.innerHTML = '';
        
        // Filter courses based on search query if necessary
        const coursesToRender = this.data.filters.searchQuery ? 
          this.filterCoursesBySearch(this.data.courses, this.data.filters.searchQuery) : 
          this.data.courses;
          
        if (coursesToRender.length === 0) {
          container.innerHTML = `
            <div class="col-span-full text-center py-10">
              <div class="text-gray-400 mb-4"><i class="fas fa-book-open text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">No Courses Available</h3>
              <p class="text-gray-500">There are currently no courses available.</p>
            </div>
          `;
          return;
        }
        
        // Create course cards using the template
        coursesToRender.forEach(course => {
          const template = document.getElementById('course-card-template');
          const card = template.content.cloneNode(true);
          
          // Set course data attributes
          const cardElement = card.querySelector('.course-card');
          cardElement.dataset.courseId = course.id;
          
          // Set image
          const img = card.querySelector('.course-image');
          img.src = course.image;
          img.alt = course.title;
          
          // Show enrollment badge if enrolled
          const isEnrolled = this.checkEnrollmentStatus(course.id);
          if (isEnrolled) {
            card.querySelector('.enrolled-badge').classList.remove('hidden');
          }
          
          // Create title container with View Course button
          const titleEl = card.querySelector('.course-title');
          const titleText = titleEl.textContent = course.title;
          
          // Add title with button container
          const titleContainer = document.createElement('div');
          titleContainer.className = 'flex items-center justify-between mb-2';
          titleEl.replaceWith(titleContainer);
          
          // Add title element
          const newTitleEl = document.createElement('h2');
          newTitleEl.className = 'course-title text-xl font-bold text-gray-800 leading-tight';
          newTitleEl.textContent = course.title;
          titleContainer.appendChild(newTitleEl);
          
          // Add View Course button
          const viewCourseBtn = document.createElement('button');
          viewCourseBtn.className = 'text-sm px-3 py-1 bg-brand-purple text-white rounded hover:bg-purple-700 ml-2 whitespace-nowrap';
          viewCourseBtn.innerHTML = '<i class="fas fa-eye mr-1"></i> View Course';
          viewCourseBtn.dataset.courseId = course.id;
          viewCourseBtn.addEventListener('click', () => {
            this.data.currentCourseId = course.id;
            this.data.currentView = 'course-details';
            this.render();
          });
          titleContainer.appendChild(viewCourseBtn);
          
          // Set the rest of the course details
          card.querySelector('.course-instructor span').textContent = course.instructor;
          card.querySelector('.course-duration span').textContent = course.duration;
          card.querySelector('.course-description').textContent = course.description;
          
          // Set up enroll/unenroll button
          this.setupEnrollButton(card, course, isEnrolled);
          
          // Set up progress section if enrolled
          if (isEnrolled) {
            this.setupProgressSection(card, course);
          }
          
          // Set up lessons section
          this.setupLessonsSection(card, course, isEnrolled);
          
          container.appendChild(card);
        });
      },

      setupEnrollButton(card, course, isEnrolled) {
        const buttonContainer = card.querySelector('.enroll-button-container');
        
        const button = document.createElement('button');
        button.className = isEnrolled ? 
          "w-full py-2 px-4 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors" : 
          "w-full py-2 px-4 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors";
        
        button.innerHTML = isEnrolled ? 
          '<i class="fas fa-user-minus mr-2"></i>Unenroll' : 
          '<i class="fas fa-user-plus mr-2"></i>Enroll in Course';
        
        button.dataset.action = isEnrolled ? 'unenroll' : 'enroll';
        button.dataset.courseId = course.id;
        
        buttonContainer.appendChild(button);
      },

      setupProgressSection(card, course) {
        const progressContainer = card.querySelector('.course-progress-container');
        
        // Calculate overall course progress
        let totalProgress = 0;
        let completedLessons = 0;
        
        course.lessons.forEach(lesson => {
          const progress = this.getLessonProgress(course.id, lesson.id);
          totalProgress += progress;
          if (progress >= 1) completedLessons++;
        });
        
        const averageProgress = course.lessons.length > 0 ? totalProgress / course.lessons.length : 0;
        const progressPercent = Math.round(averageProgress * 100);
        
        // Create progress section
        const progressSection = document.createElement('div');
        progressSection.className = 'mb-4';
        progressSection.innerHTML = `
          <div class="flex items-center justify-between mb-1">
            <span class="text-sm font-medium text-gray-700">Course Progress</span>
            <span class="text-xs text-gray-600">${completedLessons} of ${course.lessons.length} lessons completed</span>
          </div>
          <div class="progress-bar">
            <div class="progress-bar-fill" style="width: ${progressPercent}%"></div>
          </div>
          <div class="flex justify-end mt-1">
            <span class="text-xs text-gray-600">${progressPercent}% complete</span>
          </div>
        `;
        
        progressContainer.appendChild(progressSection);
      },

      setupLessonsSection(card, course, isEnrolled) {
        const lessonsContainer = card.querySelector('.lessons-container');
        
        const header = document.createElement('div');
        header.className = 'flex items-center justify-between mb-2';
        header.innerHTML = `
          <h3 class="font-medium text-gray-700">Lessons</h3>
        `;
        
        lessonsContainer.appendChild(header);
        
        // Create lessons list (show first 3 only)
        const lessonsList = document.createElement('div');
        lessonsList.className = 'space-y-2';
        
        // Show only first 3 lessons as preview
        const lessonsToShow = course.lessons.slice(0, 3);
        lessonsToShow.forEach(lesson => {
          // Use template for consistent lesson buttons
          const template = document.getElementById('lesson-button-template');
          const button = template.content.cloneNode(true);
          
          const lessonButton = button.querySelector('.lesson-button');
          lessonButton.classList.add('bg-gray-50', 'hover:bg-gray-100');
  
          if (isEnrolled) {
            lessonButton.classList.add('cursor-pointer');
          } else {
            lessonButton.classList.add('cursor-not-allowed');
            lessonButton.classList.add('opacity-60');
          }
          
          // Determine icon and style based on lesson status
          const icon = lessonButton.querySelector('.lesson-icon');
          const progress = this.getLessonProgress(course.id, lesson.id);
          
          if (progress >= 1) {
            icon.className = 'fas fa-check-circle text-green-500 mr-3';
            lessonButton.classList.add('lesson-completed');
          } else if (progress > 0) {
            if (lesson.contentType === 'video') {
              icon.className = 'fas fa-play-circle text-blue-500 mr-3';
            } else {
              icon.className = 'fas fa-file-alt text-blue-500 mr-3';
            }
            lessonButton.classList.add('lesson-in-progress');
          } else {
            if (lesson.contentType === 'video') {
              icon.className = 'fas fa-play-circle text-gray-400 mr-3';
            } else {
              icon.className = 'fas fa-file-alt text-gray-400 mr-3';
            }
          }
          
          // Set lesson title
          lessonButton.querySelector('.lesson-title').textContent = lesson.title;
          
          // Set progress info if any
          if (progress > 0 && progress < 1) {
            lessonButton.querySelector('.lesson-progress').textContent = `${Math.round(progress * 100)}%`;
          } else {
            lessonButton.querySelector('.lesson-progress').textContent = '';
          }
          
          // Add click handler if enrolled
          if (isEnrolled) {
            lessonButton.addEventListener('click', () => {
              this.data.currentCourseId = course.id;
              this.data.currentLessonId = lesson.id;
              this.data.currentView = 'course-details';
              this.render();
            });
          }
          
          lessonsList.appendChild(button);
        });
        
        lessonsContainer.appendChild(lessonsList);
        
        // If there are more lessons, add a "See all" link
        if (course.lessons.length > 3) {
          const seeAllLink = document.createElement('a');
          seeAllLink.className = 'text-xs text-gray-500 hover:text-gray-700 mt-2 inline-block';
          seeAllLink.textContent = `+ ${course.lessons.length - 3} more lessons`;
          seeAllLink.href = '#';
          seeAllLink.addEventListener('click', (e) => {
            e.preventDefault();
            this.data.currentCourseId = course.id;
            this.data.currentView = 'course-details';
            this.render();
          });
          
          lessonsContainer.appendChild(seeAllLink);
        }
      },

      // More component methods...
      
      // Utility methods
      checkEnrollmentStatus(courseId) {
        return this.userData.courses[courseId]?.enrolled === true;
      },
      
      filterCoursesBySearch(courses, query) {
        if (!query) return courses;
        
        const searchQuery = query.toLowerCase().trim();
        
        return courses.filter(course => 
          course.title.toLowerCase().includes(searchQuery) ||
          course.description.toLowerCase().includes(searchQuery) ||
          course.instructor.toLowerCase().includes(searchQuery) ||
          course.lessons.some(lesson => lesson.title.toLowerCase().includes(searchQuery))
        );
      },
      
      // Event handlers
      setupCoursesPageEventListeners() {
        // Example: Handle enroll/unenroll button clicks through delegation
        const coursesContainer = document.getElementById('courses');
        if (coursesContainer) {
          coursesContainer.addEventListener('click', (e) => {
            const enrollButton = e.target.closest('[data-action="enroll"]');
            const unenrollButton = e.target.closest('[data-action="unenroll"]');
            
            if (enrollButton) {
              const courseId = enrollButton.dataset.courseId;
              this.enrollInCourse(courseId);
            } else if (unenrollButton) {
              const courseId = unenrollButton.dataset.courseId;
              this.unenrollFromCourse(courseId);
            }
          });
        }
        
        // Setup search functionality
        const searchInput = document.getElementById('searchInput');
        const clearSearch = document.getElementById('clearSearch');
        
        if (searchInput && clearSearch) {
          searchInput.addEventListener('input', () => {
            this.data.filters.searchQuery = searchInput.value;
            
            if (searchInput.value) {
              clearSearch.classList.remove('hidden');
            } else {
              clearSearch.classList.add('hidden');
            }
            
            this.renderCourseCards();
          });
          
          clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            this.data.filters.searchQuery = '';
            clearSearch.classList.add('hidden');
            this.renderCourseCards();
          });
        }
      },
      
      // Course management methods
      enrollInCourse(courseId) {
        if (!this.userData.courses[courseId]) {
          this.userData.courses[courseId] = { lessons: {} };
        }
        
        this.userData.courses[courseId].enrolled = true;
        this.userData.courses[courseId].enrolledAt = Date.now();
        
        this.saveUserData();
        this.render(); // Re-render everything to reflect changes
        
        this.showToast('You have successfully enrolled in the course', 'success');
      },
      
      unenrollFromCourse(courseId) {
        if (confirm("Are you sure you want to unenroll from this course? Your progress will be preserved, but the course will be removed from your active courses.")) {
          if (this.userData.courses[courseId]) {
            this.userData.courses[courseId].enrolled = false;
            this.saveUserData();
            this.render();
            this.showToast('You have unenrolled from the course', 'info');
          }
        }
      },
      
      // Toast notification method
      showToast(message, type = 'info') {
        // Check if toast container exists
        let toastContainer = document.getElementById('toastContainer');
        
        if (!toastContainer) {
          // Create toast container if it doesn't exist
          toastContainer = document.createElement('div');
          toastContainer.id = 'toastContainer';
          toastContainer.className = 'fixed bottom-4 right-4 z-50 flex flex-col gap-2';
          document.body.appendChild(toastContainer);
        }
        
        // Create toast element
        const toast = document.createElement('div');
        toast.className = 'px-4 py-2 rounded-lg shadow-lg flex items-center justify-between min-w-[300px] animate-fade-in';
        
        // Set color based on type
        switch (type) {
          case 'success':
            toast.classList.add('bg-green-100', 'text-green-800', 'border-l-4', 'border-green-500');
            break;
          case 'error':
            toast.classList.add('bg-red-100', 'text-red-800', 'border-l-4', 'border-red-500');
            break;
          case 'warning':
            toast.classList.add('bg-yellow-100', 'text-yellow-800', 'border-l-4', 'border-yellow-500');
            break;
          default:
            toast.classList.add('bg-blue-100', 'text-blue-800', 'border-l-4', 'border-blue-500');
        }
        
        // Icon based on type
        let icon;
        switch (type) {
          case 'success':
            icon = '<i class="fas fa-check-circle text-green-500 mr-2"></i>';
            break;
          case 'error':
            icon = '<i class="fas fa-exclamation-circle text-red-500 mr-2"></i>';
            break;
          case 'warning':
            icon = '<i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>';
            break;
          default:
            icon = '<i class="fas fa-info-circle text-blue-500 mr-2"></i>';
        }
        
        // Toast content
        toast.innerHTML = `
          <div class="flex items-center">
            ${icon}
            <span>${message}</span>
          </div>
          <button class="text-gray-400 hover:text-gray-600 ml-4">
            <i class="fas fa-times"></i>
          </button>
        `;
        
        // Add to container
        toastContainer.appendChild(toast);
        
        // Handle close button
        const closeButton = toast.querySelector('button');
        closeButton.addEventListener('click', () => {
          toast.classList.add('opacity-0');
          setTimeout(() => {
            toast.remove();
          }, 300);
        });
        
        // Auto-remove after 5 seconds
        setTimeout(() => {
          toast.classList.add('opacity-0');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, 5000);
      },

      showLoadingIndicator() {
        const loadingOverlay = document.createElement('div');
        loadingOverlay.id = 'loadingOverlay';
        loadingOverlay.className = 'fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50';
        loadingOverlay.innerHTML = `
          <div class="bg-white p-6 rounded-lg shadow-lg text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-purple mx-auto mb-4"></div>
            <p class="text-gray-700">Loading course data...</p>
          </div>
        `;
        document.body.appendChild(loadingOverlay);
      },

      hideLoadingIndicator() {
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
          loadingOverlay.remove();
        }
      }
    };

    // Initialize the app when the DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Instead of loading from a JSON file, use the JS object directly
      AppState.initWithConfig(courseConfig);
    });
  </script>

  <footer class="bg-white border-t border-gray-200 mt-12">
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- Logo and description -->
        <div class="col-span-1 md:col-span-1">
          <div class="flex items-center">
            <i class="fas fa-graduation-cap text-brand-purple text-2xl mr-2"></i>
            <span class="text-xl font-bold text-gray-800">Learning Platform</span>
          </div>
          <p class="mt-2 text-sm text-gray-600">
            Your comprehensive online learning solution designed to help you master new skills at your own pace.
          </p>
        </div>
        
        <!-- Quick links -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Learning</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Browse Courses</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Learning Paths</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Certificates</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">For Teams</a>
            </li>
          </ul>
        </div>
        
        <!-- Resources -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Resources</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Help Center</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Knowledge Base</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Community Forums</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Developer API</a>
            </li>
          </ul>
        </div>
        
        <!-- Company -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Company</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">About Us</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Careers</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Blog</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Contact</a>
            </li>
          </ul>
        </div>
      </div>
      
      <!-- Social links and copyright -->
      <div class="mt-8 pt-6 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center">
        <div class="flex space-x-4">
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-facebook"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-linkedin"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-youtube"></i>
          </a>
        </div>
        <div class="mt-4 sm:mt-0 text-sm text-gray-500">
          &copy; 2025 Learning Platform. All rights reserved.
        </div>
      </div>
    </div>
  </footer>
</body>
</html>