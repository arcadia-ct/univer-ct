<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Learning Platform</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'brand-purple': '#6a44d9',
          }
        }
      }
    }
  </script>
  <style>
    .active-nav-item {
      background-color: #f3f4f6;
      color: #6a44d9;
    }
    
    .course-filter-badge {
      font-size: 0.75rem;
      padding: 0.125rem 0.375rem;
      border-radius: 9999px;
      background-color: #f3f4f6;
      color: #4b5563;
    }
    
    .course-filter-badge.active {
      background-color: #6a44d9;
      color: white;
    }
    
    .lesson-completed {
      border-left: 3px solid #10b981;
    }
    
    .lesson-in-progress {
      border-left: 3px solid #3b82f6;
    }
    
    /* Add progress bar styling */
    .progress-bar {
      height: 0.25rem;
      background-color: #e5e7eb;
      border-radius: 9999px;
      overflow: hidden;
    }
    
    .progress-bar-fill {
      height: 100%;
      background-color: #6a44d9;
      transition: width 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }

    .animate-fade-in {
      animation: fadeIn 0.3s ease-in-out forwards;
    }

    .opacity-0 {
      opacity: 0;
      transition: opacity 0.3s ease-out;
    }

    /* Add these styles for sidebar toggle functionality */
    .max-w-7xl {
      transition: all 0.3s ease;
    }
    
    #sidebar {
      transition: width 0.3s ease;
    }
    
    .sidebar-collapsed .flex {
      justify-content: flex-start;
    }
    
    #main-content {
      transition: all 0.3s ease;
    }
    
    .max-w-7xl.sidebar-collapsed #main-content {
      margin-left: 4rem; /* 64px to account for collapsed sidebar */
      width: calc(100% - 4rem);
    }
    
    /* Style for iconified courses in collapsed sidebar */
    .iconified-courses button {
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      position: relative;
    }
    
    .iconified-courses button::after {
      content: '';
      position: absolute;
      left: -8px;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 0;
      background-color: #6a44d9;
      transition: height 0.2s ease;
    }
    
    .iconified-courses button:hover::after,
    .iconified-courses button.active::after {
      height: 16px;
    }
  </style>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Your existing styles & Tailwind config here -->
  <script src="config.js"></script>
</head>
<body class="bg-gray-50 min-h-screen font-sans">
  <!-- Top Navigation -->
  <nav id="main-nav" class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40">
    <!-- Nav content will be rendered by JavaScript -->
  </nav>

  <!-- Additional container for width constraints if needed -->
  <div class="max-w-7xl mx-auto">
    <div class="flex">
      <!-- Sidebar stays the same -->
      <aside id="sidebar" class="w-64 bg-white border-r border-gray-200 h-[calc(100vh-4rem)] sticky top-16 overflow-y-auto transition-all duration-300 ease-in-out">
        <!-- Sidebar content will be rendered by JavaScript -->
      </aside>

      <!-- Main Content Area - will adapt when sidebar collapses -->
      <div id="main-content" class="flex-1 p-6 transition-all duration-300 ease-in-out">
        <!-- Content will be rendered by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Templates - These are hidden and used by JavaScript -->
  <div id="templates" class="hidden">
    <!-- Course Card Template -->
    <template id="course-card-template">
      <div class="course-card bg-white rounded-lg shadow-md overflow-hidden flex flex-col border border-gray-200">
        <div class="course-image-container relative">
          <img class="course-image h-48 w-full object-cover" src="" alt="">
          <div class="enrolled-badge absolute top-2 right-2 bg-green-500 text-white text-xs px-2 py-1 rounded-full hidden">
            <i class="fas fa-user-check mr-1"></i>Enrolled
          </div>
        </div>
        <div class="p-5 flex flex-col flex-1 border-t border-gray-100">
          <h2 class="course-title text-xl font-bold mb-2 text-gray-800 leading-tight"></h2>
          <p class="course-instructor text-sm text-gray-600 mb-1">
            <i class="fas fa-user-tie mr-2"></i><span></span>
          </p>
          <p class="course-duration text-sm text-gray-600 mb-3">
            <i class="fas fa-clock mr-2"></i><span></span>
          </p>
          <p class="course-description text-gray-700 text-sm mb-4 flex-grow line-clamp-3" style="min-height: 4.5rem;"></p>
          
          <!-- This ensures buttons are always at the bottom -->
          <div class="mt-auto pt-4">
            <div class="enroll-button-container mb-4">
              <!-- Buttons will be added here -->
            </div>
            <hr class="border-gray-200 mb-4">
            <div class="course-progress-container"></div>
            <div class="lessons-container" style="max-height: 12rem; overflow-y: auto;"></div>
          </div>
        </div>
      </div>
    </template>

    <!-- Lesson Button Template -->
    <template id="lesson-button-template">
      <button class="lesson-button flex items-center justify-between w-full text-left p-3 rounded-lg transition-colors">
        <div class="flex items-center">
          <i class="lesson-icon mr-3"></i>
          <span class="lesson-title"></span>
        </div>
        <div class="flex items-center">
          <span class="lesson-progress text-xs mr-2"></span>
          <span class="lesson-arrow text-gray-400">
            <i class="fas fa-chevron-right"></i>
          </span>
        </div>
      </button>
    </template>

    <!-- Course Tree Item Template -->
    <template id="course-tree-item-template">
      <li class="course-tree-item mb-2 overflow-hidden">
        <div class="flex items-center justify-between py-2 px-1 hover:bg-gray-50 rounded cursor-pointer">
          <div class="flex items-center flex-grow min-w-0">
            <span class="course-tree-toggle text-gray-400 mr-2">
              <i class="fas fa-chevron-right"></i>
            </span>
            <span class="course-icon mr-2">
              <i class="fas fa-book"></i>
            </span>
            <span class="course-tree-title truncate font-medium text-sm"></span>
          </div>
        </div>
        <div class="course-tree-lessons ml-4"></div>
      </li>
    </template>
    
    <!-- More templates for other components... -->
  </div>

  <!-- Modal Templates -->
  <div id="video-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
    <!-- Video modal content -->
  </div>

  <div id="document-modal" class="hidden fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
    <!-- Document modal content -->
  </div>

  <script>
    // Global state
    const AppState = {
      data: {
        courses: [],
        currentView: 'courses',
        currentCourseId: null,
        currentLessonId: null,
        filters: {
          courseTree: 'all',
          searchQuery: ''
        }
      },
      
      configUrl: 'courses-data.json', // Default relative path
      
      // State management methods
      async init(configUrl) {
        // Show loading indicator
        this.showLoadingIndicator();
        
        // Allow override of config URL
        if (configUrl) {
          this.configUrl = configUrl;
        }
        
        try {
          // Load configuration from external JSON file
          await this.loadConfiguration();
          
          // Load user data from localStorage
          this.loadUserData();
          
          // IMPORTANT: Parse URL first to set current view based on the URL
          this.parseURL();
          
          // Initialize UI
          this.render();
          
          // Set up event listeners for global components
          this.setupEventListeners();
          
          // Set up window popstate event for back/forward navigation
          window.addEventListener('popstate', (e) => {
            this.parseURL();
            this.render();
          });
          
        } catch (error) {
          console.error("Failed to initialize application:", error);
          this.showToast('Failed to load course data. Please try again later.', 'error');
        } finally {
          // Hide loading indicator
          this.hideLoadingIndicator();
        }
      },
      
      async loadConfiguration() {
        try {
          const response = await fetch(this.configUrl);
          
          if (!response.ok) {
            throw new Error(`Failed to load configuration from ${this.configUrl}: ${response.status} ${response.statusText}`);
          }
          
          let config;
          let jsonText = await response.text();
          
          // Try to fix common JSON syntax issues
          if (jsonText.startsWith('//')) {
            // Remove any comment lines at the beginning
            jsonText = jsonText.replace(/^\/\/.*$/gm, '').trim();
          }
          
          try {
            config = JSON.parse(jsonText);
          } catch (parseError) {
            console.error("JSON Parse Error:", parseError);
            console.error("JSON Content (first 500 chars):", jsonText.substring(0, 500));
            
            // Last resort: Create a default config
            console.warn("Using default configuration as fallback");
            config = {
              "title": "Learning Platform",
              "pageTitle": "My Courses",
              "courses": []
            };
          }
          
          // Update application with loaded configuration
          this.platformTitle = config.title || "Learning Platform";
          this.pageTitle = config.pageTitle || "My Courses";
          this.data.courses = config.courses || [];
          
          console.log(`Configuration loaded from ${this.configUrl}`);
        } catch (error) {
          console.error("Error loading configuration:", error);
          throw error;
        }
      },
      
      initWithConfig(config) {
        // Show loading indicator
        this.showLoadingIndicator();
        
        try {
          // Update application with provided configuration
          this.platformTitle = config.title || "Learning Platform";
          this.pageTitle = config.pageTitle || "My Courses";
          this.data.courses = config.courses || [];
          
          // Load user data from localStorage
          this.loadUserData();
          
          // IMPORTANT: Parse the URL before rendering
          this.parseURL();
          
          // Initialize UI
          this.render();
          
          // Set up event listeners for global components
          this.setupEventListeners();
          
          // IMPORTANT: Set up window popstate event for back/forward navigation
          window.addEventListener('popstate', (e) => {
            this.parseURL();
            this.render();
          });
          
          console.log("Configuration loaded from JS object");
        } catch (error) {
          console.error("Failed to initialize application:", error);
          this.showToast('Failed to load course data. Please try again later.', 'error');
        } finally {
          // Hide loading indicator
          this.hideLoadingIndicator();
        }
      },
      
      loadUserData() {
        const storedData = localStorage.getItem('learningData');
        if (storedData) {
          try {
            this.userData = JSON.parse(storedData);
          } catch (e) {
            console.error("Error parsing stored data:", e);
            this.userData = this.createEmptyUserData();
          }
        } else {
          this.userData = this.createEmptyUserData();
        }
      },
      
      createEmptyUserData() {
        return {
          courses: {},
          lastUpdated: Date.now()
        };
      },
      
      saveUserData() {
        this.userData.lastUpdated = Date.now();
        localStorage.setItem('learningData', JSON.stringify(this.userData));
      },
      
      render() {
        this.renderNavigation();
        this.renderSidebar();
        this.renderMainContent();
        this.updatePageTitle();
      },
      
      setupEventListeners() {
        // Global event delegation
        document.addEventListener('click', this.handleGlobalClick.bind(this));
      },
      
      handleGlobalClick(event) {
        // Example of event delegation
        if (event.target.closest('#showAllCoursesBtn')) {
          this.data.currentView = 'courses';
          this.updateURLWithoutRefresh('#courses');
          this.render();
        } else if (event.target.closest('#showMyProgressBtn')) {
          this.data.currentView = 'progress';
          this.updateURLWithoutRefresh('#progress');
          this.render();
        }
        // Add more global click handlers...
      },
      
      // Component rendering methods
      renderNavigation() {
        const nav = document.getElementById('main-nav');
        nav.innerHTML = `
          <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
              <div class="flex items-center">
                <span id="brandLogo" class="text-2xl font-bold text-brand-purple">
                  <i class="fas fa-graduation-cap mr-2"></i>
                  <span id="navTitle">${this.platformTitle}</span>
                </span>
              </div>
              
              <div class="flex items-center">
                <button class="ml-4 p-2 rounded-full hover:bg-gray-100">
                  <i class="fas fa-user-circle text-gray-500 text-xl"></i>
                </button>
              </div>
            </div>
          </div>
        `;
      },
      
      renderSidebar() {
        const sidebar = document.getElementById('sidebar');
        sidebar.innerHTML = `
          <div class="flex justify-end p-2">
            <button id="sidebarToggle" class="text-gray-500 hover:text-brand-purple p-1 rounded-md">
              <i class="fas fa-chevron-left"></i>
            </button>
          </div>
          
          <div class="p-4">
            <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3">
              Navigation
            </h3>

            <div class="space-y-2">
              <button id="showAllCoursesBtn" class="flex items-center w-full px-3 py-2 text-gray-900 rounded-md hover:bg-gray-100 group ${this.data.currentView === 'courses' ? 'active-nav-item' : ''}">
                <i class="fas fa-book-open mr-3 text-brand-purple"></i>
                <span class="font-medium">All Courses</span>
              </button>
              
              <button id="showMyProgressBtn" class="flex items-center w-full px-3 py-2 text-gray-600 rounded-md hover:bg-gray-100 group ${this.data.currentView === 'progress' ? 'active-nav-item' : ''}">
                <i class="fas fa-chart-line mr-3 text-gray-400"></i>
                <span class="font-medium">My Progress</span>
              </button>
            </div>
          </div>

          <div id="courseTree" class="mt-4 border-t border-gray-200 pt-4">
            <div class="flex items-center justify-between px-4 mb-3">
              <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider">
                Courses
              </h3>
              <div class="flex items-center space-x-1">
                <button id="filterAllCourses" class="course-filter-badge ${this.data.filters.courseTree === 'all' ? 'active' : ''}">All</button>
                <button id="filterEnrolledCourses" class="course-filter-badge ${this.data.filters.courseTree === 'enrolled' ? 'active' : ''}">Enrolled</button>
              </div>
            </div>
            
            <div class="px-2 mb-2">
              <div class="relative">
                <input 
                  id="courseTreeSearch" 
                  type="text" 
                  placeholder="Filter courses..." 
                  class="w-full py-1 px-2 pl-7 text-sm border border-gray-200 rounded focus:outline-none focus:ring-1 focus:ring-brand-purple focus:border-brand-purple"
                  value="${this.data.filters.searchQuery}"
                >
                <div class="absolute inset-y-0 left-0 flex items-center pl-2 pointer-events-none">
                  <i class="fas fa-search text-gray-400 text-xs"></i>
                </div>
                <button id="clearTreeSearch" class="absolute inset-y-0 right-0 flex items-center pr-2 text-gray-400 hover:text-gray-600 ${this.data.filters.searchQuery ? '' : 'hidden'}">
                  <i class="fas fa-times text-xs"></i>
                </button>
              </div>
            </div>
            
            <div class="space-y-1 px-2 overflow-y-auto" style="max-height: calc(100vh - 13rem);">
              <ul id="courseTreeList" class="space-y-1">
                <!-- Course tree items are rendered by renderCourseTree() -->
              </ul>
            </div>
          </div>
        `;
        
        this.renderCourseTree();
        this.setupSidebarEventListeners();
      },
      
      renderCourseTree() {
        const courseTreeList = document.getElementById('courseTreeList');
        if (!courseTreeList) return;
        
        courseTreeList.innerHTML = '';
        
        // Filter courses based on the selected filter
        let coursesToShow = this.data.courses;
        
        // If "enrolled" filter is selected, only show enrolled courses
        if (this.data.filters.courseTree === 'enrolled') {
          coursesToShow = this.data.courses.filter(course => this.checkEnrollmentStatus(course.id));
        }
        
        // If there's a search query, filter by it
        if (this.data.filters.searchQuery) {
          const query = this.data.filters.searchQuery.toLowerCase();
          coursesToShow = coursesToShow.filter(course => 
            course.title.toLowerCase().includes(query) || 
            course.description.toLowerCase().includes(query) ||
            course.lessons.some(lesson => lesson.title.toLowerCase().includes(query))
          );
        }
        
        // If no courses to show after filtering
        if (coursesToShow.length === 0) {
          courseTreeList.innerHTML = `
            <li class="px-2 py-3 text-gray-500 text-center text-sm">
              <i class="fas fa-info-circle mr-2"></i>
              No courses found
            </li>
          `;
          return;
        }
        
        // Create course tree items
        coursesToShow.forEach(course => {
          const template = document.getElementById('course-tree-item-template');
          const item = template.content.cloneNode(true);
          
          // Set course data and title
          const courseItem = item.querySelector('.course-tree-item');
          courseItem.dataset.courseId = course.id;
          item.querySelector('.course-tree-title').textContent = course.title;
          
          // Set icon based on enrollment status
          const iconElement = item.querySelector('.course-icon i');
          if (this.checkEnrollmentStatus(course.id)) {
            iconElement.className = 'fas fa-book text-green-500';
          }
          
          // Add click handler for expanding/collapsing
          const headerDiv = item.querySelector('.course-tree-item > div');
          const toggleIcon = item.querySelector('.course-tree-toggle i');
          const lessonsList = item.querySelector('.course-tree-lessons');
          
          // Initially hide lessons
          lessonsList.classList.add('hidden');
          
          // Click handler to toggle lessons visibility
          headerDiv.addEventListener('click', () => {
            lessonsList.classList.toggle('hidden');
            toggleIcon.classList.toggle('fa-chevron-right');
            toggleIcon.classList.toggle('fa-chevron-down');
          });
          
          // Populate lessons
          course.lessons.forEach(lesson => {
            const lessonItem = document.createElement('div');
            lessonItem.className = 'py-1 pl-2';
            
            // Determine if lesson is completed or in progress
            let lessonIcon, textClass;
            const progress = this.getLessonProgress(course.id, lesson.id);
            
            if (progress >= 1) {
              lessonIcon = '<i class="fas fa-check-circle text-green-500 mr-2"></i>';
              textClass = 'text-gray-700';
            } else if (progress > 0) {
              if (lesson.contentType === 'video') {
                lessonIcon = '<i class="fas fa-play-circle text-blue-500 mr-2"></i>';
              } else {
                lessonIcon = '<i class="fas fa-file-alt text-blue-500 mr-2"></i>';
              }
              textClass = 'text-gray-700';
            } else {
              if (lesson.contentType === 'video') {
                lessonIcon = '<i class="fas fa-play-circle text-gray-400 mr-2"></i>';
              } else {
                lessonIcon = '<i class="fas fa-file-alt text-gray-400 mr-2"></i>';
              }
              textClass = 'text-gray-500';
            }
            
            lessonItem.innerHTML = `
              <a href="#" class="flex items-center text-sm ${textClass} hover:text-gray-900 truncate">
                ${lessonIcon}
                <span class="truncate">${lesson.title}</span>
              </a>
            `;
            
            // Add click handler for lesson
            lessonItem.querySelector('a').addEventListener('click', (e) => {
              e.preventDefault();
              this.data.currentCourseId = course.id;
              this.data.currentLessonId = lesson.id;
              this.data.currentView = 'course-details';
              this.updateURLWithoutRefresh(`#course/${course.id}/${lesson.id}`);
              this.render();
            });
            
            lessonsList.appendChild(lessonItem);
          });
          
          courseTreeList.appendChild(item);
        });
      },

      getLessonProgress(courseId, lessonId) {
        return this.userData?.courses?.[courseId]?.lessons?.[lessonId]?.progress || 0;
      },

      isLessonCompleted(courseId, lessonId) {
        return this.getLessonProgress(courseId, lessonId) >= 1;
      },

      setupSidebarEventListeners() {
        // Course tree filter buttons
        const filterAllBtn = document.getElementById('filterAllCourses');
        const filterEnrolledBtn = document.getElementById('filterEnrolledCourses');
        
        if (filterAllBtn && filterEnrolledBtn) {
          filterAllBtn.addEventListener('click', () => {
            this.data.filters.courseTree = 'all';
            this.renderCourseTree();
          });
          
          filterEnrolledBtn.addEventListener('click', () => {
            this.data.filters.courseTree = 'enrolled';
            this.renderCourseTree();
          });
        }
        
        // Course tree search
        const searchInput = document.getElementById('courseTreeSearch');
        const clearSearch = document.getElementById('clearTreeSearch');
        
        if (searchInput && clearSearch) {
          searchInput.addEventListener('input', () => {
            this.data.filters.searchQuery = searchInput.value;
            
            if (searchInput.value) {
              clearSearch.classList.remove('hidden');
            } else {
              clearSearch.classList.add('hidden');
            }
            
            this.renderCourseTree();
          });
          
          clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            this.data.filters.searchQuery = '';
            clearSearch.classList.add('hidden');
            this.renderCourseTree();
          });
        }
        
        // Improved sidebar toggle functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const appContainer = document.querySelector('.max-w-7xl');

        if (sidebarToggle && sidebar) {
          sidebarToggle.addEventListener('click', () => {
            // Toggle sidebar collapsed state
            const sidebarCollapsed = !sidebar.classList.contains('collapsed');
            
            if (sidebarCollapsed) {
              // Collapse sidebar
              sidebar.classList.add('collapsed');
              sidebar.classList.remove('w-64');
              sidebar.classList.add('w-16');
              appContainer.classList.add('sidebar-collapsed');
              
              // Update toggle icon to show expand option
              sidebarToggle.innerHTML = '<i class="fas fa-chevron-right"></i>';
              sidebarToggle.setAttribute('title', 'Expand sidebar');
              
              // Hide text elements, show only icons
              this.updateSidebarForCollapsedState(true);
            } else {
              // Expand sidebar
              sidebar.classList.remove('collapsed');
              sidebar.classList.add('w-64');
              sidebar.classList.remove('w-16');
              appContainer.classList.remove('sidebar-collapsed');
              
              // Update toggle icon to show collapse option
              sidebarToggle.innerHTML = '<i class="fas fa-chevron-left"></i>';
              sidebarToggle.setAttribute('title', 'Collapse sidebar');
              
              // Show all sidebar content
              this.updateSidebarForCollapsedState(false);
            }
          });
        }
      },

      updateSidebarForCollapsedState(collapsed) {
        const sidebar = document.getElementById('sidebar');
        if (!sidebar) return;
        
        if (collapsed) {
          // In collapsed state, we hide text and show only icons
          
          // Update navigation items
          const navItems = sidebar.querySelectorAll('#showAllCoursesBtn, #showMyProgressBtn');
          navItems.forEach(item => {
            item.classList.add('justify-center');
            const iconEl = item.querySelector('i');
            if (iconEl) iconEl.classList.remove('mr-3');
            const textEl = item.querySelector('span');
            if (textEl) textEl.classList.add('hidden');
          });
          
          // Hide text headers and details
          const textElements = sidebar.querySelectorAll('h3, .px-4 > div, #courseTree > div, #courseTreeSearch, #courseTreeList span');
          textElements.forEach(el => el.classList.add('hidden'));
          
          // Show iconified versions of the course list
          this.renderIconifiedCourseList();
        } else {
          // In expanded state, restore all text elements
          
          // Update navigation items
          const navItems = sidebar.querySelectorAll('#showAllCoursesBtn, #showMyProgressBtn');
          navItems.forEach(item => {
            item.classList.remove('justify-center');
            const iconEl = item.querySelector('i');
            if (iconEl) iconEl.classList.add('mr-3');
            const textEl = item.querySelector('span');
            if (textEl) textEl.classList.remove('hidden');
          });
          
          // Show all text elements
          const textElements = sidebar.querySelectorAll('h3, .px-4 > div, #courseTree > div');
          textElements.forEach(el => el.classList.remove('hidden'));
          
          // Remove any iconified course list elements
          const iconifiedList = sidebar.querySelector('.iconified-courses');
          if (iconifiedList) iconifiedList.remove();
          
          // Re-render the full course tree
          this.renderCourseTree();
        }
      },

      renderIconifiedCourseList() {
        const sidebar = document.getElementById('sidebar');
        if (!sidebar) return;
        
        // Remove existing course tree content
        const courseTreeList = document.getElementById('courseTreeList');
        if (courseTreeList) courseTreeList.innerHTML = '';
        
        // Create a container for the iconified courses
        const iconList = document.createElement('div');
        iconList.className = 'iconified-courses flex flex-col items-center mt-4 space-y-4';
        
        // Filter courses based on the selected filter
        let coursesToShow = this.data.courses;
        if (this.data.filters.courseTree === 'enrolled') {
          coursesToShow = this.data.courses.filter(course => this.checkEnrollmentStatus(course.id));
        }
        
        // Add course icons
        coursesToShow.forEach(course => {
          const courseIcon = document.createElement('button');
          courseIcon.className = 'w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-brand-purple hover:bg-brand-purple hover:text-white transition-colors';
          courseIcon.title = course.title;
          courseIcon.dataset.courseId = course.id;
          
          // Show first letter of course title or a book icon
          courseIcon.innerHTML = `<i class="fas fa-book"></i>`;
          
          // Add active state if this is the current course
          if (this.data.currentCourseId === course.id) {
            courseIcon.classList.add('bg-brand-purple', 'text-white');
          }
          
          // Add click handler
          courseIcon.addEventListener('click', () => {
            this.data.currentCourseId = course.id;
            this.data.currentView = 'course-details';
            this.updateURLWithoutRefresh(`#course/${course.id}`);
            this.render();
          });
          
          iconList.appendChild(courseIcon);
        });
        
        // Add the iconified list to the sidebar
        sidebar.appendChild(iconList);
      },

      renderMainContent() {
        const mainContent = document.getElementById('main-content');
        
        // Clear content
        mainContent.innerHTML = '';
        
        // Render based on current view
        switch(this.data.currentView) {
          case 'courses':
            mainContent.appendChild(this.renderCoursesPage());
            break;
          case 'progress':
            mainContent.appendChild(this.renderProgressPage());
            break;
          case 'course-details':
            mainContent.appendChild(this.renderCourseDetailsPage());
            break;
          default:
            mainContent.appendChild(this.renderCoursesPage());
        }
      },

      renderCoursesPage() {
        const page = document.createElement('div');
        page.id = 'coursesPage';
        
        // Create header with title and search in a horizontal layout
        page.innerHTML = `
          <div class="mb-8">
            <!-- Title and search bar in a flex row -->
            <div class="flex flex-col md:flex-row md:items-center md:justify-between">
              <h1 class="text-2xl font-bold text-gray-900 mb-4 md:mb-0">${this.pageTitle || "My Courses"}</h1>
              
              <div class="relative w-full md:w-64">
                <input id="searchInput" type="text" placeholder="Search courses" 
                  class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-brand-purple focus:border-brand-purple" 
                  value="${this.data.filters.searchQuery || ''}">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                  <i class="fas fa-search text-gray-400"></i>
                </div>
                <button id="clearSearch" class="absolute inset-y-0 right-0 pr-3 flex items-center ${this.data.filters.searchQuery ? '' : 'hidden'}">
                  <i class="fas fa-times-circle text-gray-400 hover:text-gray-600"></i>
                </button>
              </div>
            </div>
          </div>
          
          <!-- Changed to 2 columns (md:grid-cols-2) instead of 3 -->
          <div id="courses" class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Course cards will be rendered here -->
          </div>
        `;
        
        // After the page is added to the DOM, render course cards and set up event listeners
        setTimeout(() => {
          this.renderCourseCards();
          this.setupCoursesPageEventListeners();
        }, 0);
        
        return page;
      },

      renderProgressPage() {
        const page = document.createElement('div');
        page.id = 'progressPage';
        page.className = 'block';
        
        // Add back button and heading in a flex container
        const headingSection = `
          <div class="flex items-center mb-4">
            <button id="backFromProgressBtn" class="text-gray-600 hover:text-gray-900 mr-3">
              <i class="fas fa-arrow-left"></i>
            </button>
            <h1 class="text-2xl font-bold text-gray-900">My Progress</h1>
          </div>
        `;
        
        // Check if user has any enrolled courses
        const enrolledCourses = this.data.courses.filter(course => this.checkEnrollmentStatus(course.id));
        
        if (enrolledCourses.length === 0) {
          // No enrolled courses
          page.innerHTML = `
            ${headingSection}
            
            <div class="text-center py-10">
              <div class="text-gray-400 mb-4"><i class="fas fa-chart-bar text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">No Enrolled Courses</h3>
              <p class="text-gray-500 mb-4">Enroll in courses to track your learning progress.</p>
              <button id="browseCoursesBtn" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                Browse Courses
              </button>
            </div>
          `;
          
          // Add click handler for the browse courses button
          setTimeout(() => {
            document.getElementById('browseCoursesBtn')?.addEventListener('click', () => {
              this.data.currentView = 'courses';
              this.updateURLWithoutRefresh('#courses');
              this.render();
            });
            
            // Add back button handler
            document.getElementById('backFromProgressBtn')?.addEventListener('click', () => {
              this.data.currentView = 'courses';
              this.updateURLWithoutRefresh('#courses');
              this.render();
            });
          }, 0);
          
          return page;
        }
        
        // User has enrolled courses - calculate overall statistics
        let totalLessons = 0;
        let completedLessons = 0;
        
        enrolledCourses.forEach(course => {
          if (course.lessons) {
            course.lessons.forEach(lesson => {
              totalLessons++;
              const progress = this.getLessonProgress(course.id, lesson.id);
              if (progress >= 1) {
                completedLessons++;
              }
            });
          }
        });
        
        const overallProgress = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;
        
        // Render the progress dashboard with the back button
        page.innerHTML = `
          ${headingSection}
          
          <div class="mb-8">
            <div class="bg-white rounded-lg shadow p-6">
              <h2 class="text-xl font-semibold text-gray-800 mb-4">Overall Progress</h2>
              
              <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-3xl font-bold text-brand-purple mb-1">${enrolledCourses.length}</div>
                  <div class="text-sm text-gray-600">Enrolled Courses</div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-3xl font-bold text-brand-purple mb-1">${completedLessons}/${totalLessons}</div>
                  <div class="text-sm text-gray-600">Lessons Completed</div>
                </div>
                
                <div class="bg-gray-50 p-4 rounded-lg">
                  <div class="text-3xl font-bold text-brand-purple mb-1">${overallProgress}%</div>
                  <div class="text-sm text-gray-600">Overall Completion</div>
                </div>
              </div>
              
              <div class="mb-2 flex justify-between text-sm">
                <span class="text-gray-600">Total Progress</span>
                <span class="font-medium">${overallProgress}%</span>
              </div>
              
              <div class="progress-bar h-2">
                <div class="progress-bar-fill" style="width: ${overallProgress}%"></div>
              </div>
            </div>
          </div>
          
          <div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Course Progress</h2>
            
            <div class="space-y-4" id="courseProgressList">
              <!-- Individual course progress will be rendered here -->
            </div>
          </div>
        `;
        
        // After the page is added to the DOM, render course progress items and add event listeners
        setTimeout(() => {
          // Render individual course progress cards
          const container = document.getElementById('courseProgressList');
          if (container) {
            enrolledCourses.forEach(course => {
              // Calculate course progress
              let totalCourseLessons = course.lessons ? course.lessons.length : 0;
              let completedCourseLessons = 0;
              let inProgressLessons = 0;
              
              if (course.lessons) {
                course.lessons.forEach(lesson => {
                  const progress = this.getLessonProgress(course.id, lesson.id);
                  if (progress >= 1) {
                    completedCourseLessons++;
                  } else if (progress > 0) {
                    inProgressLessons++;
                  }
                });
              }
              
              const progressPercent = totalCourseLessons > 0 ? 
                Math.round((completedCourseLessons / totalCourseLessons) * 100) : 0;
              
              // Create course progress item
              const courseItem = document.createElement('div');
              courseItem.className = 'bg-white rounded-lg shadow overflow-hidden';
              courseItem.innerHTML = `
                <div class="p-4 flex flex-col sm:flex-row sm:items-center justify-between">
                  <div class="mb-3 sm:mb-0">
                    <h3 class="font-semibold text-gray-800">${course.title}</h3>
                    <p class="text-sm text-gray-600">${completedCourseLessons} of ${totalCourseLessons} lessons completed</p>
                  </div>
                  
                  <div class="flex space-x-3 items-center">
                    <div class="text-right">
                      <span class="font-medium text-lg">${progressPercent}%</span>
                    </div>
                    
                    <button class="viewCourseBtn px-3 py-1 bg-brand-purple text-white rounded hover:bg-purple-700 text-sm" data-course-id="${course.id}">
                      View Course
                    </button>
                  </div>
                </div>
                
                <div class="progress-bar h-1">
                  <div class="progress-bar-fill" style="width: ${progressPercent}%"></div>
                </div>
              `;
              
              // Add click handler for view course button
              courseItem.querySelector('.viewCourseBtn').addEventListener('click', () => {
                this.data.currentCourseId = course.id;
                this.data.currentView = 'course-details';
                this.updateURLWithoutRefresh(`#course/${course.id}`);
                this.render();
              });
              
              container.appendChild(courseItem);
            });
          }
          
          // Add back button handler
          document.getElementById('backFromProgressBtn')?.addEventListener('click', () => {
            this.data.currentView = 'courses';
            this.updateURLWithoutRefresh('#courses');
            this.render();
          });
        }, 0);
        
        return page;
      },

      renderCourseDetailsPage() {
        const page = document.createElement('div');
        page.id = 'courseDetailsPage';
        
        // Find the selected course
        const course = this.data.courses.find(c => c.id === this.data.currentCourseId);
        if (!course) {
          // Course not found
          page.innerHTML = `
            <div class="text-center py-10">
              <div class="text-gray-400 mb-4"><i class="fas fa-exclamation-circle text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">Course Not Found</h3>
              <p class="text-gray-500 mb-4">The requested course could not be found.</p>
              <button id="backToCourseListBtn" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                Back to Courses
              </button>
            </div>
          `;
          
          // Add click handler for back button
          setTimeout(() => {
            document.getElementById('backToCourseListBtn')?.addEventListener('click', () => {
              this.data.currentView = 'courses';
              this.updateURLWithoutRefresh('#courses');
              this.render();
            });
          }, 0);
          
          return page;
        }
        
        // Find the selected lesson (if any)
        let selectedLesson = null;
        if (this.data.currentLessonId) {
          selectedLesson = course.lessons.find(l => l.id === this.data.currentLessonId);
          
          // If no lesson found with that ID, default to the first lesson
          if (!selectedLesson && course.lessons.length > 0) {
            selectedLesson = course.lessons[0];
            this.data.currentLessonId = selectedLesson.id;
          }
        } else if (course.lessons.length > 0) {
          // If no lesson is selected, default to the first lesson
          selectedLesson = course.lessons[0];
          this.data.currentLessonId = selectedLesson.id;
        }
        
        // Calculate course progress
        const isEnrolled = this.checkEnrollmentStatus(course.id);
        let overallProgress = 0;
        let completedLessons = 0;
        
        if (isEnrolled) {
          course.lessons.forEach(lesson => {
            if (this.getLessonProgress(course.id, lesson.id) >= 1) {
              completedLessons++;
            }
          });
          
          overallProgress = course.lessons.length > 0 
            ? Math.round((completedLessons / course.lessons.length) * 100) 
            : 0;
        }
        
        // Render the course details page
        page.innerHTML = `
          <div>
            <!-- Header with back button, title and action button -->
            <div class="flex justify-between items-center mb-6 pb-4 border-b border-gray-200">
              <div class="flex items-center">
                <button id="backToCoursesBtn" class="text-gray-600 hover:text-gray-900 mr-3">
                  <i class="fas fa-arrow-left"></i>
                </button>
                <h1 class="text-2xl font-bold text-gray-900">${course.title}</h1>
              </div>
              
              <div>
                ${isEnrolled 
                  ? `<button id="unenrollBtn" class="px-4 py-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors">
                      <i class="fas fa-user-minus mr-2"></i>Unenroll
                    </button>`
                  : `<button id="enrollBtn" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors">
                      <i class="fas fa-user-plus mr-2"></i>Enroll
                    </button>`
                }
              </div>
            </div>
            
            <!-- Course info and progress section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
              <!-- Left column: course information -->
              <div class="lg:col-span-2">
                <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                  <div class="flex flex-col md:flex-row md:items-center mb-4">
                    <!-- Course image -->
                    <div class="md:w-32 md:h-32 rounded-md overflow-hidden mr-4 mb-4 md:mb-0 flex-shrink-0">
                      <img src="${course.image || 'https://via.placeholder.com/300x200?text=Course+Image'}" alt="${course.title}" class="w-full h-full object-cover">
                    </div>
                    
                    <!-- Course info -->
                    <div>
                      <p class="text-sm text-gray-600 mb-1">
                        <i class="fas fa-user-tie mr-2"></i>${course.instructor}
                      </p>
                      <p class="text-sm text-gray-600 mb-2">
                        <i class="fas fa-clock mr-2"></i>${course.duration}
                      </p>
                      <div class="flex items-center">
                        ${isEnrolled 
                          ? `<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded">
                              <i class="fas fa-user-check mr-1"></i>Enrolled
                            </span>` 
                          : ''
                        }
                      </div>
                    </div>
                  </div>
                  
                  <h2 class="text-lg font-medium text-gray-800 mb-2">About this course</h2>
                  <p class="text-gray-700">${course.description}</p>
                </div>
              </div>
              
              <!-- Right column: progress or lessons overview -->
              <div>
                <div class="bg-white rounded-lg shadow-sm p-6 border border-gray-200">
                  ${isEnrolled 
                    ? `
                      <h2 class="text-lg font-medium text-gray-800 mb-4">Your Progress</h2>
                      <div class="mb-4">
                        <div class="flex justify-between text-sm mb-1">
                          <span class="text-gray-600">Overall Completion</span>
                          <span class="font-medium">${overallProgress}%</span>
                        </div>
                        <div class="progress-bar h-2">
                          <div class="progress-bar-fill" style="width: ${overallProgress}%"></div>
                        </div>
                      </div>
                      <div class="text-sm text-gray-600 mb-4">
                        <p><i class="fas fa-check-circle text-green-500 mr-2"></i>${completedLessons}/${course.lessons.length} lessons completed</p>
                      </div>`
                    : `
                      <h2 class="text-lg font-medium text-gray-800 mb-4">Course Overview</h2>
                      <div class="mb-4">
                        <p class="text-sm text-gray-600"><i class="fas fa-list-ul mr-2"></i>${course.lessons.length} lessons</p>
                      </div>
                      <p class="text-sm text-gray-600 mb-4">Enroll to track your progress and complete this course.</p>
                      <button id="enrollBtnTop" class="w-full px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors">
                        <i class="fas fa-user-plus mr-2"></i>Enroll Now
                      </button>`
                  }
                </div>
              </div>
            </div>
            
            <!-- Course content section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <!-- Left sidebar: Lessons list -->
              <div>
                <div class="bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
                  <div class="p-4 bg-gray-50 border-b border-gray-200">
                    <h2 class="font-medium text-gray-800">Lessons</h2>
                  </div>
                  <div class="p-2">
                    <div id="lessonsList" class="space-y-1 max-h-[600px] overflow-y-auto">
                      <!-- Lessons will be rendered here -->
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Main lesson content area -->
              <div class="lg:col-span-2">
                <div id="lessonContent" class="bg-white rounded-lg shadow-sm p-6 border border-gray-200 min-h-[600px]">
                  <!-- Lesson content will be rendered here -->
                  ${!selectedLesson 
                    ? `<div class="text-center py-20">
                        <div class="text-gray-400 mb-4"><i class="fas fa-book-open text-5xl"></i></div>
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">No Lessons Available</h3>
                        <p class="text-gray-500">This course doesn't have any lessons yet.</p>
                      </div>`
                    : ''
                  }
                </div>
              </div>
            </div>
          </div>
        `;
        
        // After the page is added to the DOM, render lessons and set up event listeners
        setTimeout(() => {
          this.renderLessonsList(course);
          
          if (selectedLesson) {
            this.renderLessonContent(course, selectedLesson);
          }
          
          // Set up event listeners
          this.setupCourseDetailsEventListeners(course.id);
        }, 0);
        
        return page;
      },

      setupCourseDetailsEventListeners(courseId) {
        // Back button
        const backBtn = document.getElementById('backToCoursesBtn');
        if (backBtn) {
          backBtn.addEventListener('click', () => {
            this.data.currentView = 'courses';
            this.updateURLWithoutRefresh('#courses');
            this.render();
          });
        }
        
        // Enroll buttons
        const enrollBtn = document.getElementById('enrollBtn');
        if (enrollBtn) {
          enrollBtn.addEventListener('click', () => {
            this.enrollInCourse(courseId);
          });
        }
        
        const enrollBtnTop = document.getElementById('enrollBtnTop');
        if (enrollBtnTop) {
          enrollBtnTop.addEventListener('click', () => {
            this.enrollInCourse(courseId);
          });
        }
        
        // Unenroll button
        const unenrollBtn = document.getElementById('unenrollBtn');
        if (unenrollBtn) {
          unenrollBtn.addEventListener('click', () => {
            this.unenrollFromCourse(courseId);
          });
        }
      },

      renderLessonsList(course) {
        const lessonsListEl = document.getElementById('lessonsList');
        if (!lessonsListEl) return;
        
        // Clear existing content
        lessonsListEl.innerHTML = '';
        
        // If no lessons
        if (!course.lessons || course.lessons.length === 0) {
          lessonsListEl.innerHTML = '<p class="text-sm text-gray-500 p-2">No lessons available</p>';
          return;
        }
        
        // Render each lesson
        course.lessons.forEach(lesson => {
          const isActive = lesson.id === this.data.currentLessonId;
          const isCompleted = this.isLessonCompleted(course.id, lesson.id);
          const progress = this.getLessonProgress(course.id, lesson.id);
          
          // Create lesson item
          const lessonItem = document.createElement('div');
          lessonItem.className = `rounded-md overflow-hidden ${isActive ? 'bg-gray-100 border-l-4 border-brand-purple' : ''}`;
          
          // Determine icon based on content type and completion status
          let icon;
          if (isCompleted) {
            icon = '<i class="fas fa-check-circle text-green-500"></i>';
          } else {
            if (lesson.contentType === 'video') {
              icon = '<i class="fas fa-play-circle text-brand-purple"></i>';
            } else {
              icon = '<i class="fas fa-file-alt text-brand-purple"></i>';
            }
          }
          
          // Determine progress display
          let progressDisplay = '';
          if (progress > 0 && progress < 1) {
            progressDisplay = `<span class="text-xs text-gray-500">${Math.round(progress * 100)}%</span>`;
          } else if (progress >= 1) {
            progressDisplay = '<span class="text-xs text-green-500">Completed</span>';
          }
          
          lessonItem.innerHTML = `
            <button class="w-full px-3 py-3 text-left flex items-center justify-between">
              <div class="flex items-center">
                <span class="mr-3">${icon}</span>
                <span class="text-sm ${isActive ? 'font-medium text-gray-900' : 'text-gray-700'}">${lesson.title}</span>
              </div>
              <div class="flex items-center">
                ${progressDisplay}
                <span class="ml-2 text-gray-400">
                  <i class="fas fa-chevron-right"></i>
                </span>
              </div>
            </button>
          `;
          
          // Add click handler
          lessonItem.querySelector('button').addEventListener('click', () => {
            this.data.currentLessonId = lesson.id;
            this.updateURLWithoutRefresh(`#course/${course.id}/${lesson.id}`);
            this.renderLessonContent(course, lesson);
          });
          
          lessonsListEl.appendChild(lessonItem);
        });
      },

      renderLessonContent(course, lesson) {
        const contentContainer = document.getElementById('lessonContent');
        if (!contentContainer) return;
        
        // Clear existing content
        contentContainer.innerHTML = '';
        
        // Create header with lesson title and completion status
        const header = document.createElement('div');
        header.className = 'flex justify-between items-center mb-6 pb-3 border-b border-gray-200';
        
        header.innerHTML = `
          <h2 class="text-xl font-bold text-gray-900">${lesson.title}</h2>
          <div>
            ${this.isLessonCompleted(course.id, lesson.id) 
              ? '<span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded"><i class="fas fa-check-circle mr-1"></i>Completed</span>'
              : ''}
          </div>
        `;
        
        contentContainer.appendChild(header);
        
        // Create lesson content based on content type
        if (lesson.contentType === 'video') {
          this.renderVideoLesson(contentContainer, lesson);
        } else if (lesson.contentType === 'document') {
          this.renderDocumentLesson(contentContainer, lesson);
        } else {
          // Unknown content type
          contentContainer.innerHTML += `
            <div class="text-center py-20">
              <div class="text-gray-400 mb-4"><i class="fas fa-exclamation-circle text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">Unsupported Content</h3>
              <p class="text-gray-500">This lesson contains content that cannot be displayed.</p>
            </div>
          `;
        }
        
        // If enrolled, add mark as complete button at the bottom
        if (this.checkEnrollmentStatus(course.id)) {
          const isCompleted = this.isLessonCompleted(course.id, lesson.id);
          
          const completionSection = document.createElement('div');
          completionSection.className = 'mt-8 pt-4 border-t border-gray-200';
          
          if (isCompleted) {
            completionSection.innerHTML = `
              <button id="markAsIncompleteBtn" class="px-4 py-2 border border-gray-300 rounded text-gray-600 hover:bg-gray-50">
                <i class="far fa-circle mr-2"></i>Mark as Incomplete
              </button>
            `;
            
            // Add event listener
            setTimeout(() => {
              document.getElementById('markAsIncompleteBtn')?.addEventListener('click', () => {
                this.markLessonIncomplete(course.id, lesson.id);
              });
            }, 0);
          } else {
            completionSection.innerHTML = `
              <button id="markAsCompleteBtn" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600">
                <i class="fas fa-check-circle mr-2"></i>Mark as Complete
              </button>
            `;
            
            // Add event listener
            setTimeout(() => {
              document.getElementById('markAsCompleteBtn')?.addEventListener('click', () => {
                this.markLessonComplete(course.id, lesson.id);
              });
            }, 0);
          }
          
          contentContainer.appendChild(completionSection);
        }
      },

      renderVideoLesson(container, lesson) {
        const videoContainer = document.createElement('div');
        videoContainer.className = 'aspect-w-16 aspect-h-9 mb-4';
        
        if (lesson.videoUrl) {
          // If YouTube video
          if (lesson.videoUrl.includes('youtube.com') || lesson.videoUrl.includes('youtu.be')) {
            let videoId = '';
            
            // Extract YouTube video ID
            if (lesson.videoUrl.includes('v=')) {
              videoId = lesson.videoUrl.split('v=')[1].split('&')[0];
            } else if (lesson.videoUrl.includes('youtu.be/')) {
              videoId = lesson.videoUrl.split('youtu.be/')[1];
            }
            
            if (videoId) {
              videoContainer.innerHTML = `
                <iframe 
                  src="https://www.youtube.com/embed/${videoId}" 
                  class="w-full h-96"
                  frameborder="0" 
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                  allowfullscreen>
                </iframe>
              `;
            } else {
              videoContainer.innerHTML = `
                <div class="bg-gray-100 w-full h-96 flex items-center justify-center">
                  <p class="text-gray-500">Unable to load video</p>
                </div>
              `;
            }
          } else {
            // If direct video URL
            videoContainer.innerHTML = `
              <video controls class="w-full h-full">
                <source src="${lesson.videoUrl}" type="video/mp4">
                Your browser does not support the video tag.
              </video>
            `;
          }
        } else if (lesson.sharePointUrl) {
          // SharePoint embed
          videoContainer.innerHTML = `
            <div class="bg-gray-100 w-full h-96 flex flex-col items-center justify-center">
              <p class="text-gray-500 mb-4">Video hosted on SharePoint</p>
              <a href="${lesson.sharePointUrl}" target="_blank" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                <i class="fas fa-external-link-alt mr-2"></i>Open in SharePoint
              </a>
            </div>
          `;
        } else {
          // No valid video source
          videoContainer.innerHTML = `
            <div class="bg-gray-100 w-full h-96 flex items-center justify-center">
              <p class="text-gray-500">No video available</p>
            </div>
          `;
        }
        
        container.appendChild(videoContainer);
        
        // Add description if available
        if (lesson.description) {
          const description = document.createElement('div');
          description.className = 'mt-4 text-gray-700';
          description.innerHTML = `<p>${lesson.description}</p>`;
          container.appendChild(description);
        }
        
        // Add additional resources if available
        if (lesson.additionalResources && lesson.additionalResources.length > 0) {
          const resourcesSection = document.createElement('div');
          resourcesSection.className = 'mt-6 pt-4 border-t border-gray-200';
          
          resourcesSection.innerHTML = `
            <h3 class="font-medium text-gray-800 mb-3">Additional Resources</h3>
            <ul class="space-y-2">
              ${lesson.additionalResources.map(resource => `
                <li>
                  <a href="${resource.url}" target="_blank" class="flex items-center p-2 border border-gray-200 rounded hover:bg-gray-50">
                    <span class="mr-3">
                      ${resource.type === 'pdf' ? '<i class="far fa-file-pdf text-red-500"></i>' : ''}
                      ${resource.type === 'doc' ? '<i class="far fa-file-word text-blue-500"></i>' : ''}
                      ${resource.type === 'ppt' ? '<i class="far fa-file-powerpoint text-orange-500"></i>' : ''}
                      ${resource.type === 'link' ? '<i class="fas fa-link text-purple-500"></i>' : ''}
                    </span>
                    <div>
                      <p class="font-medium text-sm">${resource.title}</p>
                      <p class="text-xs text-gray-500">${resource.description || ''}</p>
                    </div>
                  </a>
                </li>
              `).join('')}
            </ul>
          `;
          
          container.appendChild(resourcesSection);
        }
      },

      renderDocumentLesson(container, lesson) {
        const documentContainer = document.createElement('div');
        documentContainer.className = 'mb-4';
        
        // Determine document type icon and styling
        let documentIcon, documentColor;
        
        switch(lesson.documentType) {
          case 'pdf':
            documentIcon = 'far fa-file-pdf';
            documentColor = 'text-red-500';
            break;
          case 'word':
          case 'doc':
            documentIcon = 'far fa-file-word';
            documentColor = 'text-blue-500';
            break;
          case 'powerpoint':
          case 'ppt':
            documentIcon = 'far fa-file-powerpoint';
            documentColor = 'text-orange-500';
            break;
          case 'excel':
          case 'xlsx':
            documentIcon = 'far fa-file-excel';
            documentColor = 'text-green-500';
            break;
          default:
            documentIcon = 'far fa-file';
            documentColor = 'text-gray-500';
        }
        
        // If document has an embed URL or can be embedded directly
        if (lesson.documentUrl) {
          // For PDFs, we can embed them directly
          if (lesson.documentType === 'pdf') {
            documentContainer.innerHTML = `
              <div class="w-full h-[800px] border border-gray-200 rounded">
                <object data="${lesson.documentUrl}" type="application/pdf" width="100%" height="100%">
                  <p>It appears your browser doesn't support embedded PDFs. 
                  <a href="${lesson.documentUrl}" target="_blank">Click here to download the PDF</a>.</p>
                </object>
              </div>
            `;
          } else {
            // For other document types, provide download link
            documentContainer.innerHTML = `
              <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 flex flex-col items-center justify-center">
                <div class="text-5xl ${documentColor} mb-4">
                  <i class="${documentIcon}"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">${lesson.title}</h3>
                <p class="text-gray-500 mb-4">Click the button below to access the document</p>
                <a href="${lesson.documentUrl}" target="_blank" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                  <i class="fas fa-download mr-2"></i>Download Document
                </a>
              </div>
            `;
          }
        } else if (lesson.sharePointUrl) {
          // SharePoint document
          documentContainer.innerHTML = `
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 flex flex-col items-center justify-center">
              <div class="text-5xl ${documentColor} mb-4">
                <i class="${documentIcon}"></i>
              </div>
              <h3 class="text-lg font-medium text-gray-900 mb-2">${lesson.title}</h3>
              <p class="text-gray-500 mb-4">This document is hosted on SharePoint</p>
              <a href="${lesson.sharePointUrl}" target="_blank" class="px-4 py-2 bg-brand-purple text-white rounded hover:bg-purple-700">
                <i class="fas fa-external-link-alt mr-2"></i>Open in SharePoint
              </a>
            </div>
          `;
        } else {
          // No valid document source
          documentContainer.innerHTML = `
            <div class="bg-gray-50 p-6 rounded-lg border border-gray-200 text-center">
              <p class="text-gray-500">No document available</p>
            </div>
          `;
        }
        
        container.appendChild(documentContainer);
        
        // Add description if available
        if (lesson.description) {
          const description = document.createElement('div');
          description.className = 'mt-4 text-gray-700';
          description.innerHTML = `<p>${lesson.description}</p>`;
          container.appendChild(description);
        }
      },

      markLessonComplete(courseId, lessonId) {
        // Make sure the user data structure exists
        if (!this.userData.courses[courseId]) {
          this.userData.courses[courseId] = {
            enrolled: true,
            enrolledAt: Date.now(),
            lessons: {}
          };
        }
        
        if (!this.userData.courses[courseId].lessons) {
          this.userData.courses[courseId].lessons = {};
        }
        
        // Update lesson progress
        this.userData.courses[courseId].lessons[lessonId] = {
          progress: 1,
          lastAccessed: Date.now(),
          completedAt: Date.now()
        };
        
        // Save user data
        this.saveUserData();
        
        // Re-render the current lesson
        const course = this.data.courses.find(c => c.id === courseId);
        const lesson = course.lessons.find(l => l.id === lessonId);
        
        this.renderLessonsList(course);
        this.renderLessonContent(course, lesson);
        
        // Show success toast
        this.showToast('Lesson marked as complete!', 'success');
      },

      markLessonIncomplete(courseId, lessonId) {
        // Update lesson progress
        if (this.userData.courses[courseId]?.lessons?.[lessonId]) {
          this.userData.courses[courseId].lessons[lessonId].progress = 0;
          delete this.userData.courses[courseId].lessons[lessonId].completedAt;
          
          // Save user data
          this.saveUserData();
          
          // Re-render the current lesson
          const course = this.data.courses.find(c => c.id === courseId);
          const lesson = course.lessons.find(l => l.id === lessonId);
          
          this.renderLessonsList(course);
          this.renderLessonContent(course, lesson);
          
          // Show info toast
          this.showToast('Lesson marked as incomplete', 'info');
        }
      },

      renderCourseCards() {
        const coursesContainer = document.getElementById('courses');
        if (!coursesContainer) return;
        
        // Clear existing cards
        coursesContainer.innerHTML = '';
        
        // Filter courses based on search
        const filteredCourses = this.filterCoursesBySearch(this.data.courses, this.data.filters.searchQuery);
        
        // If no courses found
        if (filteredCourses.length === 0) {
          coursesContainer.innerHTML = `
            <div class="col-span-full text-center py-10">
              <div class="text-gray-400 mb-4"><i class="fas fa-search text-5xl"></i></div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">No Courses Found</h3>
              <p class="text-gray-500">Try adjusting your search criteria</p>
            </div>
          `;
          return;
        }
        
        // Create course cards
        filteredCourses.forEach(course => {
          const template = document.getElementById('course-card-template');
          const card = template.content.cloneNode(true);
          
          // Set image
          const imgElement = card.querySelector('.course-image');
          imgElement.src = course.image || 'https://via.placeholder.com/300x200?text=Course+Image';
          imgElement.alt = course.title;
          
          // Show enrolled badge if user is enrolled
          if (this.checkEnrollmentStatus(course.id)) {
            card.querySelector('.enrolled-badge').classList.remove('hidden');
          }
          
          // Set title, instructor, duration, description
          card.querySelector('.course-title').textContent = course.title;
          card.querySelector('.course-instructor span').textContent = course.instructor;
          card.querySelector('.course-duration span').textContent = course.duration;
          card.querySelector('.course-description').textContent = course.description;
          
          // Set up the buttons container
          this.setupEnrollButton(card, course, this.checkEnrollmentStatus(course.id));
          
          // Set up lessons preview
          this.setupLessonsPreview(card, course, this.checkEnrollmentStatus(course.id));
          
          // Add card to container
          coursesContainer.appendChild(card);
        });
      },

      setupEnrollButton(card, course, isEnrolled) {
        // Clear the existing button container
        const buttonContainer = card.querySelector('.enroll-button-container');
        buttonContainer.innerHTML = '';
        
        // Create a flex container for both buttons
        const buttonsRow = document.createElement('div');
        buttonsRow.className = 'flex gap-2 w-full';
        
        // Create View Course button
        const viewCourseBtn = document.createElement('button');
        viewCourseBtn.className = "flex-1 py-2 px-2 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors text-sm";
        viewCourseBtn.innerHTML = '<i class="fas fa-eye mr-1"></i> View Course';
        viewCourseBtn.dataset.courseId = course.id;
        viewCourseBtn.addEventListener('click', () => {
          this.data.currentCourseId = course.id;
          this.data.currentView = 'course-details';
          this.updateURLWithoutRefresh(`#course/${course.id}`);
          this.render();
        });
        
        // Create Enroll/Unenroll button
        const actionButton = document.createElement('button');
        actionButton.className = isEnrolled 
          ? "flex-1 py-2 px-2 bg-red-50 text-red-600 border border-red-200 rounded hover:bg-red-100 transition-colors text-sm" 
          : "flex-1 py-2 px-2 bg-brand-purple text-white rounded hover:bg-purple-700 transition-colors text-sm";
        
        actionButton.innerHTML = isEnrolled 
          ? '<i class="fas fa-user-minus mr-1"></i>Unenroll' 
          : '<i class="fas fa-user-plus mr-1"></i>Enroll';
        
        actionButton.dataset.action = isEnrolled ? 'unenroll' : 'enroll';
        actionButton.dataset.courseId = course.id;
        
        // Add buttons to the flex container
        buttonsRow.appendChild(viewCourseBtn);
        buttonsRow.appendChild(actionButton);
        
        // Add the flex container to the button container
        buttonContainer.appendChild(buttonsRow);
        
        // If enrolled, also show progress
        if (isEnrolled) {
          this.setupProgressSection(card, course);
        }
      },

      setupLessonsPreview(card, course, isEnrolled) {
        const lessonsContainer = card.querySelector('.lessons-container');
        if (!lessonsContainer || !course.lessons || course.lessons.length === 0) {
          lessonsContainer.innerHTML = '<p class="text-sm text-gray-500">No lessons available</p>';
          return;
        }
        
        // Header with lesson count
        lessonsContainer.innerHTML = `
          <div class="flex justify-between items-center mb-2">
            <h3 class="text-sm font-medium text-gray-700">Lessons</h3>
            <span class="text-xs text-gray-500">${course.lessons.length} lessons</span>
          </div>
        `;
        
        // Number of lessons to show (all if enrolled, otherwise just a few)
        const lessonsToShow = isEnrolled ? course.lessons : course.lessons.slice(0, 2);
        
        // Create lesson list
        const lessonList = document.createElement('div');
        lessonList.className = 'space-y-1';
        
        lessonsToShow.forEach(lesson => {
          const lessonTemplate = document.getElementById('lesson-button-template');
          const lessonEl = lessonTemplate.content.cloneNode(true);
          
          // Set icon based on content type
          const iconEl = lessonEl.querySelector('.lesson-icon');
          if (lesson.contentType === 'video') {
            iconEl.className = 'lesson-icon fas fa-play-circle text-brand-purple mr-3';
          } else {
            iconEl.className = 'lesson-icon fas fa-file-alt text-brand-purple mr-3';
          }
          
          // Set title
          lessonEl.querySelector('.lesson-title').textContent = lesson.title;
          
          // If enrolled, show progress
          if (isEnrolled) {
            const progress = this.getLessonProgress(course.id, lesson.id);
            if (progress >= 1) {
              lessonEl.querySelector('.lesson-progress').textContent = 'Completed';
              lessonEl.querySelector('.lesson-button').classList.add('lesson-completed');
            } else if (progress > 0) {
              lessonEl.querySelector('.lesson-progress').textContent = `${Math.round(progress * 100)}%`;
              lessonEl.querySelector('.lesson-button').classList.add('lesson-in-progress');
            }
          }
          
          // Add click event
          lessonEl.querySelector('.lesson-button').addEventListener('click', () => {
            this.data.currentCourseId = course.id;
            this.data.currentLessonId = lesson.id;
            this.data.currentView = 'course-details';
            this.updateURLWithoutRefresh(`#course/${course.id}/${lesson.id}`);
            this.render();
          });
          
          lessonList.appendChild(lessonEl);
        });
        
        lessonsContainer.appendChild(lessonList);
        
        // If not enrolled and there are more lessons, show a "more lessons" message
        if (!isEnrolled && course.lessons.length > 2) {
          const moreInfo = document.createElement('p');
          moreInfo.className = 'text-xs text-gray-500 mt-2';
          moreInfo.textContent = `+ ${course.lessons.length - 2} more lessons`;
          lessonsContainer.appendChild(moreInfo);
        }
      },

      setupProgressSection(card, course) {
        const progressContainer = card.querySelector('.course-progress-container');
        if (!progressContainer) return;
        
        // Calculate progress
        let completedLessons = 0;
        let totalLessons = course.lessons.length;
        
        course.lessons.forEach(lesson => {
          if (this.getLessonProgress(course.id, lesson.id) >= 1) {
            completedLessons++;
          }
        });
        
        const progressPercent = totalLessons > 0 ? Math.round((completedLessons / totalLessons) * 100) : 0;
        
        // Add progress bar
        progressContainer.innerHTML = `
          <div class="mb-4">
            <div class="flex justify-between text-xs mb-1">
              <span class="text-gray-600">Progress</span>
              <span class="font-medium">${completedLessons}/${totalLessons} lessons (${progressPercent}%)</span>
            </div>
            <div class="progress-bar">
              <div class="progress-bar-fill" style="width: ${progressPercent}%"></div>
            </div>
          </div>
        `;
      },

      generateSlug(text) {
        return text.toString().toLowerCase()
          .replace(/\s+/g, '-')           // Replace spaces with -
          .replace(/[^\w\-]+/g, '')       // Remove all non-word chars
          .replace(/\-\-+/g, '-')         // Replace multiple - with single -
          .replace(/^-+/, '')             // Trim - from start of text
          .replace(/-+$/, '');            // Trim - from end of text
      },

      updateURLWithoutRefresh(path) {
        if (history.pushState) {
          const baseUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
          const newUrl = baseUrl + path;
          history.pushState({path: path}, '', newUrl);
        }
      },

      parseURL() {
        // Get the URL hash (everything after the # symbol)
        const hash = window.location.hash.substring(1);
        
        if (!hash) {
          // Default view if no hash
          this.data.currentView = 'courses';
          this.data.currentCourseId = null;
          this.data.currentLessonId = null;
          return;
        }
        
        // Split the hash by /
        const parts = hash.split('/');
        
        // Parse the view type
        if (parts[0] === 'courses') {
          this.data.currentView = 'courses';
          this.data.currentCourseId = null;
          this.data.currentLessonId = null;
        } else if (parts[0] === 'progress') {
          this.data.currentView = 'progress';
          this.data.currentCourseId = null;
          this.data.currentLessonId = null;
        } else if (parts[0] === 'course') {
          this.data.currentView = 'course-details';
          this.data.currentCourseId = parts[1] || null;
          this.data.currentLessonId = parts[2] || null;
          
          // If a course ID is provided but no lesson ID, find the first lesson
          if (this.data.currentCourseId && !this.data.currentLessonId) {
            const course = this.data.courses.find(c => c.id === this.data.currentCourseId);
            if (course && course.lessons && course.lessons.length > 0) {
              this.data.currentLessonId = course.lessons[0].id;
            }
          }
        }
        
        console.log("URL parsed:", {
          view: this.data.currentView,
          courseId: this.data.currentCourseId,
          lessonId: this.data.currentLessonId
        });
      },

      updatePageTitle() {
        let title = this.platformTitle || "Learning Platform";
        
        if (this.data.currentView === 'courses') {
          title = `${this.pageTitle || "My Courses"} | ${this.platformTitle}`;
        } else if (this.data.currentView === 'progress') {
          title = `My Progress | ${this.platformTitle}`;
        } else if (this.data.currentView === 'course-details' && this.data.currentCourseId) {
          const course = this.data.courses.find(c => c.id === this.data.currentCourseId);
          if (course) {
            if (this.data.currentLessonId) {
              const lesson = course.lessons.find(l => l.id === this.data.currentLessonId);
              if (lesson) {
                title = `${lesson.title} - ${course.title} | ${this.platformTitle}`;
              } else {
                title = `${course.title} | ${this.platformTitle}`;
              }
            } else {
              title = `${course.title} | ${this.platformTitle}`;
            }
          }
        }
        
        document.title = title;
      },

      // More component methods...
      
      // Utility methods
      checkEnrollmentStatus(courseId) {
        return this.userData.courses[courseId]?.enrolled === true;
      },
      
      filterCoursesBySearch(courses, query) {
        if (!query) return courses;
        
        const searchQuery = query.toLowerCase().trim();
        
        return courses.filter(course => 
          course.title.toLowerCase().includes(searchQuery) ||
          course.description.toLowerCase().includes(searchQuery) ||
          course.instructor.toLowerCase().includes(searchQuery) ||
          course.lessons.some(lesson => lesson.title.toLowerCase().includes(searchQuery))
        );
      },
      
      // Event handlers
      setupCoursesPageEventListeners() {
        // Example: Handle enroll/unenroll button clicks through delegation
        const coursesContainer = document.getElementById('courses');
        if (coursesContainer) {
          coursesContainer.addEventListener('click', (e) => {
            const enrollButton = e.target.closest('[data-action="enroll"]');
            const unenrollButton = e.target.closest('[data-action="unenroll"]');
            
            if (enrollButton) {
              const courseId = enrollButton.dataset.courseId;
              this.enrollInCourse(courseId);
            } else if (unenrollButton) {
              const courseId = unenrollButton.dataset.courseId;
              this.unenrollFromCourse(courseId);
            }
          });
        }
        
        // Setup search functionality
        const searchInput = document.getElementById('searchInput');
        const clearSearch = document.getElementById('clearSearch');
        
        if (searchInput && clearSearch) {
          searchInput.addEventListener('input', () => {
            this.data.filters.searchQuery = searchInput.value;
            
            if (searchInput.value) {
              clearSearch.classList.remove('hidden');
            } else {
              clearSearch.classList.add('hidden');
            }
            
            this.renderCourseCards();
          });
          
          clearSearch.addEventListener('click', () => {
            searchInput.value = '';
            this.data.filters.searchQuery = '';
            clearSearch.classList.add('hidden');
            this.renderCourseCards();
          });
        }
      },
      
      // Course management methods
      enrollInCourse(courseId) {
        if (!this.userData.courses[courseId]) {
          this.userData.courses[courseId] = { lessons: {} };
        }
        
        this.userData.courses[courseId].enrolled = true;
        this.userData.courses[courseId].enrolledAt = Date.now();
        
        this.saveUserData();
        this.render(); // Re-render everything to reflect changes
        
        this.showToast('You have successfully enrolled in the course', 'success');
      },
      
      unenrollFromCourse(courseId) {
        if (confirm("Are you sure you want to unenroll from this course? Your progress will be preserved, but the course will be removed from your active courses.")) {
          if (this.userData.courses[courseId]) {
            this.userData.courses[courseId].enrolled = false;
            this.saveUserData();
            this.render();
            this.showToast('You have unenrolled from the course', 'info');
          }
        }
      },
      
      // Toast notification method
      showToast(message, type = 'info') {
        // Check if toast container exists
        let toastContainer = document.getElementById('toastContainer');
        
        if (!toastContainer) {
          // Create toast container if it doesn't exist
          toastContainer = document.createElement('div');
          toastContainer.id = 'toastContainer';
          toastContainer.className = 'fixed bottom-4 right-4 z-50 flex flex-col gap-2';
          document.body.appendChild(toastContainer);
        }
        
        // Create toast element
        const toast = document.createElement('div');
        toast.className = 'px-4 py-2 rounded-lg shadow-lg flex items-center justify-between min-w-[300px] animate-fade-in';
        
        // Set color based on type
        switch (type) {
          case 'success':
            toast.classList.add('bg-green-100', 'text-green-800', 'border-l-4', 'border-green-500');
            break;
          case 'error':
            toast.classList.add('bg-red-100', 'text-red-800', 'border-l-4', 'border-red-500');
            break;
          case 'warning':
            toast.classList.add('bg-yellow-100', 'text-yellow-800', 'border-l-4', 'border-yellow-500');
            break;
          default:
            toast.classList.add('bg-blue-100', 'text-blue-800', 'border-l-4', 'border-blue-500');
        }
        
        // Icon based on type
        let icon;
        switch (type) {
          case 'success':
            icon = '<i class="fas fa-check-circle text-green-500 mr-2"></i>';
            break;
          case 'error':
            icon = '<i class="fas fa-exclamation-circle text-red-500 mr-2"></i>';
            break;
          case 'warning':
            icon = '<i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>';
            break;
          default:
            icon = '<i class="fas fa-info-circle text-blue-500 mr-2"></i>';
        }
        
        // Toast content
        toast.innerHTML = `
          <div class="flex items-center">
            ${icon}
            <span>${message}</span>
          </div>
          <button class="text-gray-400 hover:text-gray-600 ml-4">
            <i class="fas fa-times"></i>
          </button>
        `;
        
        // Add to container
        toastContainer.appendChild(toast);
        
        // Handle close button
        const closeButton = toast.querySelector('button');
        closeButton.addEventListener('click', () => {
          toast.classList.add('opacity-0');
          setTimeout(() => {
            toast.remove();
          }, 300);
        });
        
        // Auto-remove after 5 seconds
        setTimeout(() => {
          toast.classList.add('opacity-0');
          setTimeout(() => {
            toast.remove();
          }, 300);
        }, 5000);
      },

      showLoadingIndicator() {
        const loadingOverlay = document.createElement('div');
        loadingOverlay.id = 'loadingOverlay';
        loadingOverlay.className = 'fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50';
        loadingOverlay.innerHTML = `
          <div class="bg-white p-6 rounded-lg shadow-lg text-center">
            <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-purple mx-auto mb-4"></div>
            <p class="text-gray-700">Loading course data...</p>
          </div>
        `;
        document.body.appendChild(loadingOverlay);
      },

      hideLoadingIndicator() {
        const loadingOverlay = document.getElementById('loadingOverlay');
        if (loadingOverlay) {
          loadingOverlay.remove();
        }
      }
    };

    // Initialize the app when the DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Instead of loading from a JSON file, use the JS object directly
      AppState.initWithConfig(courseConfig);
    });
  </script>

  <footer class="bg-white border-t border-gray-200 mt-12">
    <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <!-- Logo and description -->
        <div class="col-span-1 md:col-span-1">
          <div class="flex items-center">
            <i class="fas fa-graduation-cap text-brand-purple text-2xl mr-2"></i>
            <span class="text-xl font-bold text-gray-800">Learning Platform</span>
          </div>
          <p class="mt-2 text-sm text-gray-600">
            Your comprehensive online learning solution designed to help you master new skills at your own pace.
          </p>
        </div>
        
        <!-- Quick links -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Learning</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Browse Courses</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Learning Paths</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Certificates</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">For Teams</a>
            </li>
          </ul>
        </div>
        
        <!-- Resources -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Resources</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Help Center</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Knowledge Base</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Community Forums</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Developer API</a>
            </li>
          </ul>
        </div>
        
        <!-- Company -->
        <div>
          <h3 class="text-sm font-semibold text-gray-500 uppercase tracking-wider mb-4">Company</h3>
          <ul class="space-y-2">
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">About Us</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Careers</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Blog</a>
            </li>
            <li>
              <a href="#" class="text-gray-600 hover:text-brand-purple text-sm">Contact</a>
            </li>
          </ul>
        </div>
      </div>
      
      <!-- Social links and copyright -->
      <div class="mt-8 pt-6 border-t border-gray-100 flex flex-col sm:flex-row justify-between items-center">
        <div class="flex space-x-4">
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-twitter"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-facebook"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-instagram"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-linkedin"></i>
          </a>
          <a href="#" class="text-gray-400 hover:text-brand-purple">
            <i class="fab fa-youtube"></i>
          </a>
        </div>
        <div class="mt-4 sm:mt-0 text-sm text-gray-500">
          &copy; 2025 Learning Platform. All rights reserved.
        </div>
      </div>
    </div>
  </footer>
</body>
</html>